"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};module.exports=function(wx){var Modules={DeleteMsgInput:function(){var e={};this.setType=function(t){e.type=t},this.setConversationId=function(t){e.conversationId=t},this.setMsgs=function(t){e.msgs=t},this.toArrayBuffer=function(){return e}},DeleteMsg:function(){var e={};this.setMsgId=function(t){e.msgId=t},this.setMsgDataTime=function(t){e.msgDataTime=t},this.setDirect=function(t){e.direct=t},this.toArrayBuffer=function(){return e}},DeleteMsgOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},SearchMpInput:function(){var e={};this.setType=function(t){e.type=t},this.setId=function(t){e.id=t},this.toArrayBuffer=function(){return e}},SearchMpOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},MpInfo:function(){var e={};this.setMpid=function(t){e.mpid=t},this.setName=function(t){e.name=t},this.setType=function(t){e.type=t},this.setTime=function(t){e.time=t},this.setPortraitUri=function(t){e.portraitUrl=t},this.setExtra=function(t){e.extra=t},this.toArrayBuffer=function(){return e}},PullMpInput:function(){var e={};this.setMpid=function(t){e.mpid=t},this.setTime=function(t){e.time=t},this.toArrayBuffer=function(){return e}},PullMpOutput:function(){var e={};this.setStatus=function(t){e.status=t},this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},MPFollowInput:function(){var e={};this.setId=function(t){e.id=t},this.toArrayBuffer=function(){return e}},MPFollowOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},NotifyMsg:function(){var e={};this.setType=function(t){e.type=t},this.setTime=function(t){e.time=t},this.setChrmId=function(t){e.chrmId=t},this.toArrayBuffer=function(){return e}},SyncRequestMsg:function(){var e={};this.setSyncTime=function(t){e.syncTime=t||0},this.setIspolling=function(t){e.ispolling=!!t},this.setIsweb=function(t){e.isweb=!!t},this.setIsPullSend=function(t){e.isPullSend=!!t},this.setSendBoxSyncTime=function(t){e.sendBoxSyncTime=t},this.toArrayBuffer=function(){return e}},UpStreamMessage:function(){var e={};this.setSessionId=function(t){e.sessionId=t},this.setClassname=function(t){e.classname=t},this.setContent=function(t){t&&(e.content=t)},this.setPushText=function(t){e.pushText=t},this.setUserId=function(t){e.userId=t},this.setAppData=function(t){e.appData=t},this.toArrayBuffer=function(){return e}},DownStreamMessages:function(){var e={};this.setList=function(t){e.list=t},this.setSyncTime=function(t){e.syncTime=t},this.toArrayBuffer=function(){return e}},DownStreamMessage:function(){var e={};this.setFromUserId=function(t){e.fromUserId=t},this.setType=function(t){e.type=t},this.setGroupId=function(t){e.groupId=t},this.setClassname=function(t){e.classname=t},this.setContent=function(t){t&&(e.content=t)},this.setDataTime=function(t){e.dataTime=t},this.setStatus=function(t){e.status=t},this.setMsgId=function(t){e.msgId=t},this.toArrayBuffer=function(){return e}},CreateDiscussionInput:function(){var e={};this.setName=function(t){e.name=t},this.toArrayBuffer=function(){return e}},CreateDiscussionOutput:function(){var e={};this.setId=function(t){e.id=t},this.toArrayBuffer=function(){return e}},ChannelInvitationInput:function(){var e={};this.setUsers=function(t){e.users=t},this.toArrayBuffer=function(){return e}},LeaveChannelInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},QueryChatroomInfoInput:function(){var e={};this.setCount=function(t){e.count=t},this.setOrder=function(t){e.order=t},this.toArrayBuffer=function(){return e}},QueryChatroomInfoOutput:function(){var e={};this.setUserTotalNums=function(t){e.userTotalNums=t},this.setUserInfos=function(t){e.userInfos=t},this.toArrayBuffer=function(){return e}},ChannelEvictionInput:function(){var e={};this.setUser=function(t){e.user=t},this.toArrayBuffer=function(){return e}},RenameChannelInput:function(){var e={};this.setName=function(t){e.name=t},this.toArrayBuffer=function(){return e}},ChannelInfoInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},ChannelInfoOutput:function(){var e={};this.setType=function(t){e.type=t},this.setChannelId=function(t){e.channelId=t},this.setChannelName=function(t){e.channelName=t},this.setAdminUserId=function(t){e.adminUserId=t},this.setFirstTenUserIds=function(t){e.firstTenUserIds=t},this.setOpenStatus=function(t){e.openStatus=t},this.toArrayBuffer=function(){return e}},ChannelInfosInput:function(){var e={};this.setPage=function(t){e.page=t},this.setNumber=function(t){e.number=t},this.toArrayBuffer=function(){return e}},ChannelInfosOutput:function(){var e={};this.setChannels=function(t){e.channels=t},this.setTotal=function(t){e.total=t},this.toArrayBuffer=function(){return e}},MemberInfo:function(){var e={};this.setUserId=function(t){e.userId=t},this.setUserName=function(t){e.userName=t},this.setUserPortrait=function(t){e.userPortrait=t},this.setExtension=function(t){e.extension=t},this.toArrayBuffer=function(){return e}},GroupMembersInput:function(){var e={};this.setPage=function(t){e.page=t},this.setNumber=function(t){e.number=t},this.toArrayBuffer=function(){return e}},GroupMembersOutput:function(){var e={};this.setMembers=function(t){e.members=t},this.setTotal=function(t){e.total=t},this.toArrayBuffer=function(){return e}},GetUserInfoInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},GetUserInfoOutput:function(){var e={};this.setUserId=function(t){e.userId=t},this.setUserName=function(t){e.userName=t},this.setUserPortrait=function(t){e.userPortrait=t},this.toArrayBuffer=function(){return e}},GetSessionIdInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},GetSessionIdOutput:function(){var e={};this.setSessionId=function(t){e.sessionId=t},this.toArrayBuffer=function(){return e}},GetQNupTokenInput:function(){var e={};this.setType=function(t){e.type=t},this.toArrayBuffer=function(){return e}},GetQNupTokenOutput:function(){var e={};this.setDeadline=function(t){e.deadline=t},this.setToken=function(t){e.token=t},this.toArrayBuffer=function(){return e}},GetQNdownloadUrlInput:function(){var e={};this.setType=function(t){e.type=t},this.setKey=function(t){e.key=t},this.setFileName=function(t){e.fileName=t},this.toArrayBuffer=function(){return e}},GetQNdownloadUrlOutput:function(){var e={};this.setDownloadUrl=function(t){e.downloadUrl=t},this.toArrayBuffer=function(){return e}},Add2BlackListInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.toArrayBuffer=function(){return e}},RemoveFromBlackListInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.toArrayBuffer=function(){return e}},QueryBlackListInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},QueryBlackListOutput:function(){var e={};this.setUserIds=function(t){e.userIds=t},this.toArrayBuffer=function(){return e}},BlackListStatusInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.toArrayBuffer=function(){return e}},BlockPushInput:function(){var e={};this.setBlockeeId=function(t){e.blockeeId=t},this.toArrayBuffer=function(){return e}},ModifyPermissionInput:function(){var e={};this.setOpenStatus=function(t){e.openStatus=t},this.toArrayBuffer=function(){return e}},GroupInput:function(){var e={};this.setGroupInfo=function(t){for(var n=0,o=[];n<t.length;n++)o.push({id:t[n].getContent().id,name:t[n].getContent().name});e.groupInfo=o},this.toArrayBuffer=function(){return e}},GroupOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},GroupInfo:function(){var e={};this.setId=function(t){e.id=t},this.setName=function(t){e.name=t},this.getContent=function(){return e},this.toArrayBuffer=function(){return e}},GroupHashInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.setGroupHashCode=function(t){e.groupHashCode=t},this.toArrayBuffer=function(){return e}},GroupHashOutput:function(){var e={};this.setResult=function(t){e.result=t},this.toArrayBuffer=function(){return e}},ChrmInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},ChrmOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},ChrmPullMsg:function(){var e={};this.setSyncTime=function(t){e.syncTime=t},this.setCount=function(t){e.count=t},this.toArrayBuffer=function(){return e}},RelationsInput:function(){var e={};this.setType=function(t){e.type=t},this.setMsg=function(t){e.msg=t},this.setCount=function(t){e.count=t},this.toArrayBuffer=function(){return e}},RelationsOutput:function(){var e={};this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},RelationInfo:function(){var e={};this.setType=function(t){e.type=t},this.setUserId=function(t){e.userId=t},this.setMsg=function(t){e.msg=t},this.toArrayBuffer=function(){return e}},HistoryMessageInput:function(){var e={};this.setTargetId=function(t){e.targetId=t},this.setDataTime=function(t){e.dataTime=t},this.setSize=function(t){e.size=t},this.toArrayBuffer=function(){return e}},HistoryMessagesOuput:function(){var e={};this.setList=function(t){e.list=t},this.setSyncTime=function(t){e.syncTime=t},this.setHasMsg=function(t){e.hasMsg=t},this.toArrayBuffer=function(){return e}},HistoryMsgInput:function(){var e={};this.setTargetId=function(t){e.targetId=t},this.setTime=function(t){e.time=t},this.setCount=function(t){e.count=t},this.setOrder=function(t){e.order=t},this.toArrayBuffer=function(){return e}},HistoryMsgOuput:function(){var e={};this.setList=function(t){e.list=t},this.setSyncTime=function(t){e.syncTime=t},this.setHasMsg=function(t){e.hasMsg=t},this.toArrayBuffer=function(){return e}}};for(var f in Modules)Modules[f].decode=function(b){var back={},val=JSON.parse(b)||eval("("+b+")");for(var i in val)back[i]=val[i],back["get"+i.charAt(0).toUpperCase()+i.slice(1)]=function(){return val[i]};return back};var RongIMLib={},tools={convertToken:function(e){var t=wx.getSystemInfoSync();t.platform;return e},isFunction:function(e){return"[object Function]"==Object.prototype.toString.call(e)},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},request:function(e,t){var n=e.url,o=e.method||"get";o=o.toUpperCase();var s=e.data||{},r=e.header||{};return wx.request({url:n,method:o,data:s,header:r,success:t.success,fail:t.fail})},socket:function(e,t){var n=e.url,o=e.method||"get";o=o.toUpperCase();var s=e.data||{},r=e.header||{};return wx.connectSocket({url:n,data:s,method:o,header:r}),wx.onSocketOpen(function(e){t.open(wx,e)}),wx.onSocketError(t.error),wx.onSocketMessage(t.message),wx.onSocketClose(t.close),wx},tplEngine:function(e,t,n){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var o=[],s=0,r=t.length;s<r;s++)o.push(function(t){return e.replace(n||/{([^}]+)}/g,function(e,n){return"\\"==e.charAt(0)?e.slice(1):void 0!=t[n]?t[n]:"{"+n+"}"})}(t[s]));return o.join("")},Watcher:function(){this.watcherList=[],this.checkIndexOutBound=function(e,t){return e>-1&&e<t},this.add=function(e,t){t&&(this.watcherList.length=0),tools.isFunction(e)&&this.watcherList.push(e)},this.get=function(e){if(this.checkIndexOutBound(e,this.watcherList.length))return this.watcherList[e]},this.count=function(){return this.watcherList.length},this.removeAt=function(e){this.checkIndexOutBound(e,this.watcherList.length)&&this.watcherList.splice(e,1)},this.remove=function(e){if(!e)return void(this.watcherList.length=0);if(tools.isFunction(e)&&(watchers=[e]),tools.isArray(e))for(var t=0,n=watchers.length;t<n;t++)for(var o=0;o<this.watcherList.length;o++)if(watchers[t]===this.watcherList[o]){this.removeAt(t);break}},this.notify=function(e){for(var t=0,n=this.watcherList.length;t<n;t++)this.watcherList[t](e)},this.indexOf=function(e,t){for(var n=t||0,o=this.watcherList.length;n<o;){if(this.watcherList[n]===e)return n;n++}return-1}}};!function(e){function t(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function o(e,o,s,r,i,a){return t(n(t(t(o,e),t(r,a)),i),s)}function s(e,t,n,s,r,i,a){return o(t&n|~t&s,e,t,r,i,a)}function r(e,t,n,s,r,i,a){return o(t&s|n&~s,e,t,r,i,a)}function i(e,t,n,s,r,i,a){return o(t^n^s,e,t,r,i,a)}function a(e,t,n,s,r,i,a){return o(n^(t|~s),e,t,r,i,a)}function c(e,n){e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;var o,c,u,g,p,d=1732584193,l=-271733879,f=-1732584194,h=271733878;for(o=0;o<e.length;o+=16)c=d,u=l,g=f,p=h,d=s(d,l,f,h,e[o],7,-680876936),h=s(h,d,l,f,e[o+1],12,-389564586),f=s(f,h,d,l,e[o+2],17,606105819),l=s(l,f,h,d,e[o+3],22,-1044525330),d=s(d,l,f,h,e[o+4],7,-176418897),h=s(h,d,l,f,e[o+5],12,1200080426),f=s(f,h,d,l,e[o+6],17,-1473231341),l=s(l,f,h,d,e[o+7],22,-45705983),d=s(d,l,f,h,e[o+8],7,1770035416),h=s(h,d,l,f,e[o+9],12,-1958414417),f=s(f,h,d,l,e[o+10],17,-42063),l=s(l,f,h,d,e[o+11],22,-1990404162),d=s(d,l,f,h,e[o+12],7,1804603682),h=s(h,d,l,f,e[o+13],12,-40341101),f=s(f,h,d,l,e[o+14],17,-1502002290),l=s(l,f,h,d,e[o+15],22,1236535329),d=r(d,l,f,h,e[o+1],5,-165796510),h=r(h,d,l,f,e[o+6],9,-1069501632),f=r(f,h,d,l,e[o+11],14,643717713),l=r(l,f,h,d,e[o],20,-373897302),d=r(d,l,f,h,e[o+5],5,-701558691),h=r(h,d,l,f,e[o+10],9,38016083),f=r(f,h,d,l,e[o+15],14,-660478335),l=r(l,f,h,d,e[o+4],20,-405537848),d=r(d,l,f,h,e[o+9],5,568446438),h=r(h,d,l,f,e[o+14],9,-1019803690),f=r(f,h,d,l,e[o+3],14,-187363961),l=r(l,f,h,d,e[o+8],20,1163531501),d=r(d,l,f,h,e[o+13],5,-1444681467),h=r(h,d,l,f,e[o+2],9,-51403784),f=r(f,h,d,l,e[o+7],14,1735328473),l=r(l,f,h,d,e[o+12],20,-1926607734),d=i(d,l,f,h,e[o+5],4,-378558),h=i(h,d,l,f,e[o+8],11,-2022574463),f=i(f,h,d,l,e[o+11],16,1839030562),l=i(l,f,h,d,e[o+14],23,-35309556),d=i(d,l,f,h,e[o+1],4,-1530992060),h=i(h,d,l,f,e[o+4],11,1272893353),f=i(f,h,d,l,e[o+7],16,-155497632),l=i(l,f,h,d,e[o+10],23,-1094730640),d=i(d,l,f,h,e[o+13],4,681279174),h=i(h,d,l,f,e[o],11,-358537222),f=i(f,h,d,l,e[o+3],16,-722521979),l=i(l,f,h,d,e[o+6],23,76029189),d=i(d,l,f,h,e[o+9],4,-640364487),h=i(h,d,l,f,e[o+12],11,-421815835),f=i(f,h,d,l,e[o+15],16,530742520),l=i(l,f,h,d,e[o+2],23,-995338651),d=a(d,l,f,h,e[o],6,-198630844),h=a(h,d,l,f,e[o+7],10,1126891415),f=a(f,h,d,l,e[o+14],15,-1416354905),l=a(l,f,h,d,e[o+5],21,-57434055),d=a(d,l,f,h,e[o+12],6,1700485571),h=a(h,d,l,f,e[o+3],10,-1894986606),f=a(f,h,d,l,e[o+10],15,-1051523),l=a(l,f,h,d,e[o+1],21,-2054922799),d=a(d,l,f,h,e[o+8],6,1873313359),h=a(h,d,l,f,e[o+15],10,-30611744),f=a(f,h,d,l,e[o+6],15,-1560198380),l=a(l,f,h,d,e[o+13],21,1309151649),d=a(d,l,f,h,e[o+4],6,-145523070),h=a(h,d,l,f,e[o+11],10,-1120210379),f=a(f,h,d,l,e[o+2],15,718787259),l=a(l,f,h,d,e[o+9],21,-343485551),d=t(d,c),l=t(l,u),f=t(f,g),h=t(h,p);return[d,l,f,h]}function u(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function g(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function p(e){return u(c(g(e),8*e.length))}function d(e,t){var n,o,s=g(e),r=[],i=[];for(r[15]=i[15]=void 0,s.length>16&&(s=c(s,8*e.length)),n=0;n<16;n+=1)r[n]=909522486^s[n],i[n]=1549556828^s[n];return o=c(r.concat(g(t)),512+8*t.length),u(c(i.concat(o),640))}function l(e){var t,n,o="0123456789abcdef",s="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),s+=o.charAt(t>>>4&15)+o.charAt(15&t);return s}function f(e){return unescape(encodeURIComponent(e))}function h(e){return p(f(e))}function m(e){return l(h(e))}function M(e,t){return d(f(e),f(t))}function I(e,t){return l(M(e,t))}function C(e,t,n){return t?n?M(t,e):I(t,e):n?h(e):m(e)}e.md5=C}(RongIMLib);var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(e){!function(e){e[e.ALL=1]="ALL",e[e.PART=2]="PART"}(e.MentionedType||(e.MentionedType={}));e.MentionedType;!function(e){e[e.CUSTOMER_SERVICE=1]="CUSTOMER_SERVICE",e[e.RECALL=2]="RECALL"}(e.MethodType||(e.MethodType={}));e.MethodType;!function(e){e[e.IN_BLACK_LIST=0]="IN_BLACK_LIST",e[e.NOT_IN_BLACK_LIST=1]="NOT_IN_BLACK_LIST"}(e.BlacklistStatus||(e.BlacklistStatus={}));e.BlacklistStatus;!function(e){e[e.XHR_POLLING=0]="XHR_POLLING",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.HTTP=0]="HTTP",e[e.HTTPS=1]="HTTPS"}(e.ConnectionChannel||(e.ConnectionChannel={}));e.ConnectionChannel;!function(e){e[e.ONLY_ROBOT=1]="ONLY_ROBOT",e[e.ONLY_HUMAN=2]="ONLY_HUMAN",e[e.ROBOT_FIRST=3]="ROBOT_FIRST",e[e.HUMAN_FIRST=4]="HUMAN_FIRST"}(e.CustomerType||(e.CustomerType={}));e.CustomerType;!function(e){e[e.NONE=0]="NONE",e[e.SQQUENCE=1]="SQQUENCE",e[e.REVERSE=2]="REVERSE"}(e.GetChatRoomType||(e.GetChatRoomType={}));e.GetChatRoomType;!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT",e[e.CONNECTION_CLOSED=4]="CONNECTION_CLOSED"}(e.ConnectionStatus||(e.ConnectionStatus={}));e.ConnectionStatus;!function(e){e[e.DO_NOT_DISTURB=0]="DO_NOT_DISTURB",e[e.NOTIFY=1]="NOTIFY"}(e.ConversationNotificationStatus||(e.ConversationNotificationStatus={}));e.ConversationNotificationStatus;!function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE"}(e.ConversationType||(e.ConversationType={}));e.ConversationType;!function(e){e[e.OPENED=0]="OPENED",e[e.CLOSED=1]="CLOSED"}(e.DiscussionInviteStatus||(e.DiscussionInviteStatus={}));e.DiscussionInviteStatus;!function(e){e[e.MINI_PROGAM_SERVICE_NOT_OPEN=2e4]="MINI_PROGAM_SERVICE_NOT_OPEN",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.RC_MSG_UNAUTHORIZED=20406]="RC_MSG_UNAUTHORIZED",e[e.RC_DISCUSSION_GROUP_ID_INVALID=20407]="RC_DISCUSSION_GROUP_ID_INVALID",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.RC_CHATROOM_USER_KICKED=23409]="RC_CHATROOM_USER_KICKED",e[e.RC_CHATROOM_NOT_EXIST=23410]="RC_CHATROOM_NOT_EXIST",e[e.RC_CHATROOM_IS_FULL=23411]="RC_CHATROOM_IS_FULL",e[e.RC_CHATROOM_PATAMETER_INVALID=23412]="RC_CHATROOM_PATAMETER_INVALID",e[e.CHATROOM_GET_HISTORYMSG_ERROR=23413]="CHATROOM_GET_HISTORYMSG_ERROR",e[e.CHATROOM_NOT_OPEN_HISTORYMSG_STORE=23414]="CHATROOM_NOT_OPEN_HISTORYMSG_STORE",e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",e[e.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.MSG_INSERT_ERROR=33008]="MSG_INSERT_ERROR",e[e.MSG_DEL_ERROR=33009]="MSG_DEL_ERROR",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.CONVER_CLEAR_ERROR=34007]="CONVER_CLEAR_ERROR",e[e.CONVER_GET_ERROR=34008]="CONVER_GET_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE",e[e.GET_MESSAGE_BY_ID_ERROR=61001]="GET_MESSAGE_BY_ID_ERROR",e[e.HAVNODEVICEID=24001]="HAVNODEVICEID",e[e.DEVICEIDISHAVE=24002]="DEVICEIDISHAVE",e[e.SUCCESS=0]="SUCCESS",e[e.FEILD=24009]="FEILD",e[e.VOIPISNULL=24013]="VOIPISNULL",e[e.NOENGINETYPE=24010]="NOENGINETYPE",e[e.NULLCHANNELNAME=24011]="NULLCHANNELNAME",e[e.VOIPDYANMICERROR=24012]="VOIPDYANMICERROR",e[e.NOVOIP=24014]="NOVOIP",e[e.INTERNALERRROR=24015]="INTERNALERRROR",e[e.VOIPCLOSE=24016]="VOIPCLOSE",e[e.CLOSE_BEFORE_OPEN=51001]="CLOSE_BEFORE_OPEN",e[e.ALREADY_IN_USE=51002]="ALREADY_IN_USE",e[e.INVALID_CHANNEL_NAME=51003]="INVALID_CHANNEL_NAME",e[e.VIDEO_CONTAINER_IS_NULL=51004]="VIDEO_CONTAINER_IS_NULL",e[e.DELETE_MESSAGE_ID_IS_NULL=61001]="DELETE_MESSAGE_ID_IS_NULL",e[e.CANCEL=1]="CANCEL",e[e.REJECT=2]="REJECT",e[e.HANGUP=3]="HANGUP",e[e.BUSYLINE=4]="BUSYLINE",e[e.NO_RESPONSE=5]="NO_RESPONSE",e[e.ENGINE_UN_SUPPORTED=6]="ENGINE_UN_SUPPORTED",e[e.NETWORK_ERROR=7]="NETWORK_ERROR",e[e.REMOTE_CANCEL=11]="REMOTE_CANCEL",e[e.REMOTE_REJECT=12]="REMOTE_REJECT",e[e.REMOTE_HANGUP=13]="REMOTE_HANGUP",e[e.REMOTE_BUSYLINE=14]="REMOTE_BUSYLINE",e[e.REMOTE_NO_RESPONSE=15]="REMOTE_NO_RESPONSE",e[e.REMOTE_ENGINE_UN_SUPPORTED=16]="REMOTE_ENGINE_UN_SUPPORTED",e[e.REMOTE_NETWORK_ERROR=17]="REMOTE_NETWORK_ERROR",e[e.VOIP_NOT_AVALIABLE=18]="VOIP_NOT_AVALIABLE"}(e.ErrorCode||(e.ErrorCode={}));e.ErrorCode;!function(e){e[e.MEDIA_AUDIO=1]="MEDIA_AUDIO",e[e.MEDIA_VEDIO=2]="MEDIA_VEDIO"}(e.VoIPMediaType||(e.VoIPMediaType={}));e.VoIPMediaType;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=100]="FILE"}(e.MediaType||(e.MediaType={}));e.MediaType;!function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(e.MessageDirection||(e.MessageDirection={}));e.MessageDirection;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=4]="FILE"}(e.FileType||(e.FileType={}));e.FileType;!function(e){e[e.RC_REAL_TIME_LOCATION_NOT_INIT=-1]="RC_REAL_TIME_LOCATION_NOT_INIT",e[e.RC_REAL_TIME_LOCATION_SUCCESS=0]="RC_REAL_TIME_LOCATION_SUCCESS",e[e.RC_REAL_TIME_LOCATION_GPS_DISABLED=1]="RC_REAL_TIME_LOCATION_GPS_DISABLED",e[e.RC_REAL_TIME_LOCATION_CONVERSATION_NOT_SUPPORT=2]="RC_REAL_TIME_LOCATION_CONVERSATION_NOT_SUPPORT",e[e.RC_REAL_TIME_LOCATION_IS_ON_GOING=3]="RC_REAL_TIME_LOCATION_IS_ON_GOING",e[e.RC_REAL_TIME_LOCATION_EXCEED_MAX_PARTICIPANT=4]="RC_REAL_TIME_LOCATION_EXCEED_MAX_PARTICIPANT",e[e.RC_REAL_TIME_LOCATION_JOIN_FAILURE=5]="RC_REAL_TIME_LOCATION_JOIN_FAILURE",e[e.RC_REAL_TIME_LOCATION_START_FAILURE=6]="RC_REAL_TIME_LOCATION_START_FAILURE",e[e.RC_REAL_TIME_LOCATION_NETWORK_UNAVAILABLE=7]="RC_REAL_TIME_LOCATION_NETWORK_UNAVAILABLE"}(e.RealTimeLocationErrorCode||(e.RealTimeLocationErrorCode={}));e.RealTimeLocationErrorCode;!function(e){e[e.RC_REAL_TIME_LOCATION_STATUS_IDLE=0]="RC_REAL_TIME_LOCATION_STATUS_IDLE",e[e.RC_REAL_TIME_LOCATION_STATUS_INCOMING=1]="RC_REAL_TIME_LOCATION_STATUS_INCOMING",e[e.RC_REAL_TIME_LOCATION_STATUS_OUTGOING=2]="RC_REAL_TIME_LOCATION_STATUS_OUTGOING",e[e.RC_REAL_TIME_LOCATION_STATUS_CONNECTED=3]="RC_REAL_TIME_LOCATION_STATUS_CONNECTED"}(e.RealTimeLocationStatus||(e.RealTimeLocationStatus={}));e.RealTimeLocationStatus;!function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED",e[e.UNREAD=0]="UNREAD"}(e.ReceivedStatus||(e.ReceivedStatus={}));e.ReceivedStatus;!function(e){e[e.EXACT=0]="EXACT",e[e.FUZZY=1]="FUZZY"}(e.SearchType||(e.SearchType={}));e.SearchType;!function(e){e[e.SENDING=10]="SENDING",e[e.FAILED=20]="FAILED",e[e.SENT=30]="SENT",e[e.RECEIVED=40]="RECEIVED",e[e.READ=50]="READ",e[e.DESTROYED=60]="DESTROYED"}(e.SentStatus||(e.SentStatus={}));e.SentStatus;!function(e){e[e.ACCEPTED=0]="ACCEPTED",e[e.UNACCEPTABLE_PROTOCOL_VERSION=1]="UNACCEPTABLE_PROTOCOL_VERSION",e[e.IDENTIFIER_REJECTED=2]="IDENTIFIER_REJECTED",e[e.SERVER_UNAVAILABLE=3]="SERVER_UNAVAILABLE",e[e.TOKEN_INCORRECT=4]="TOKEN_INCORRECT",e[e.NOT_AUTHORIZED=5]="NOT_AUTHORIZED",e[e.REDIRECT=6]="REDIRECT",e[e.PACKAGE_ERROR=7]="PACKAGE_ERROR",e[e.APP_BLOCK_OR_DELETE=8]="APP_BLOCK_OR_DELETE",e[e.BLOCK=9]="BLOCK",e[e.TOKEN_EXPIRE=10]="TOKEN_EXPIRE",e[e.DEVICE_ERROR=11]="DEVICE_ERROR"}(e.ConnectionState||(e.ConnectionState={}));e.ConnectionState}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(){}return t.getInstance=function(){if(!t._instance)throw new Error("RongIMClient is not initialized. Call .init() method first.");return t._instance},t.init=function(n,o,s){if(t._instance)return t._memoryStore.sdkInfo;t._instance=new t,s=s||{};var r=s.protocol||"https://",i=s.wsScheme||"wss://";t._storageProvider=e.LocalStorageProvider,t._Cahche={conversationList:[],callbacks:[]};var a=e.ObjectTools.buildOptions(s,{navi:r+"nav.cn.ronghub.com",api:r+"api.cn.ronghub.com",isPolling:!0,wsScheme:i,cookieValidity:1,protocol:r,openMp:!0,cmp:"cometproxy-cn.ronghub.com",maxConversationCount:300},r);(new e.FeaturePatcher).patchAll();var c={token:"",callback:null,hasModules:!0,global:window,lastReadTime:new e.LimitableMap,conversationList:[],appKey:n,publicServiceMap:new e.PublicServiceMap,providerType:1,deltaTime:0,filterMessages:[],isSyncRemoteConverList:!1,isUseWebSQLProvider:!1,otherDevice:!1,custStore:{},converStore:{latestMessage:{}},connectAckTime:0,voipStategy:0,isFirstPingMsg:!0,depend:a,listenerList:t._memoryStore.listenerList};t._memoryStore=c,o&&"[object Object]"==Object.prototype.toString.call(o)?t._dataAccessProvider=o:t._dataAccessProvider=new e.ServerDataProvider,t._dataAccessProvider.init(n),t.MessageParams={TextMessage:{objectName:"RC:TxtMsg",msgTag:new e.MessageTag(!0,!0)},ImageMessage:{objectName:"RC:ImgMsg",msgTag:new e.MessageTag(!0,!0)},DiscussionNotificationMessage:{objectName:"RC:DizNtf",msgTag:new e.MessageTag(!0,!0)},VoiceMessage:{objectName:"RC:VcMsg",msgTag:new e.MessageTag(!0,!0)},RichContentMessage:{objectName:"RC:ImgTextMsg",msgTag:new e.MessageTag(!0,!0)},FileMessage:{objectName:"RC:FileMsg",msgTag:new e.MessageTag(!0,!0)},HandshakeMessage:{objectName:"",msgTag:new e.MessageTag(!0,!0)},UnknownMessage:{objectName:"",msgTag:new e.MessageTag(!0,!0)},LocationMessage:{objectName:"RC:LBSMsg",msgTag:new e.MessageTag(!0,!0)},InformationNotificationMessage:{objectName:"RC:InfoNtf",msgTag:new e.MessageTag(!0,!0)},ContactNotificationMessage:{objectName:"RC:ContactNtf",msgTag:new e.MessageTag(!0,!0)},ProfileNotificationMessage:{objectName:"RC:ProfileNtf",msgTag:new e.MessageTag(!0,!0)},CommandNotificationMessage:{objectName:"RC:CmdNtf",msgTag:new e.MessageTag(!0,!0)},PublicServiceRichContentMessage:{objectName:"RC:PSImgTxtMsg",msgTag:new e.MessageTag(!0,!0)},PublicServiceMultiRichContentMessage:{objectName:"RC:PSMultiImgTxtMsg",msgTag:new e.MessageTag(!0,!0)},JrmfReadPacketMessage:{objectName:"RCJrmf:RpMsg",msgTag:new e.MessageTag(!0,!0)},JrmfReadPacketOpenedMessage:{objectName:"RCJrmf:RpOpendMsg",msgTag:new e.MessageTag(!0,!0)},GroupNotificationMessage:{objectName:"RC:GrpNtf",msgTag:new e.MessageTag(!0,!0)},CommandMessage:{objectName:"RC:CmdMsg",msgTag:new e.MessageTag(!1,!1)},TypingStatusMessage:{objectName:"RC:TypSts",msgTag:new e.MessageTag(!1,!1)},PublicServiceCommandMessage:{objectName:"RC:PSCmd",msgTag:new e.MessageTag(!1,!1)},RecallCommandMessage:{objectName:"RC:RcCmd",msgTag:new e.MessageTag(!1,!0)},SyncReadStatusMessage:{objectName:"RC:SRSMsg",msgTag:new e.MessageTag(!1,!1)},ReadReceiptRequestMessage:{objectName:"RC:RRReqMsg",msgTag:new e.MessageTag(!1,!1)},ReadReceiptResponseMessage:{objectName:"RC:RRRspMsg",msgTag:new e.MessageTag(!1,!1)},ChangeModeResponseMessage:{objectName:"RC:CsChaR",msgTag:new e.MessageTag(!1,!1)},ChangeModeMessage:{objectName:"RC:CSCha",msgTag:new e.MessageTag(!1,!1)},EvaluateMessage:{objectName:"RC:CsEva",msgTag:new e.MessageTag(!1,!1)},CustomerContact:{objectName:"RC:CsContact",msgTag:new e.MessageTag(!1,!1)},HandShakeMessage:{objectName:"RC:CsHs",msgTag:new e.MessageTag(!1,!1)},HandShakeResponseMessage:{objectName:"RC:CsHsR",msgTag:new e.MessageTag(!1,!1)},SuspendMessage:{objectName:"RC:CsSp",msgTag:new e.MessageTag(!1,!1)},TerminateMessage:{objectName:"RC:CsEnd",msgTag:new e.MessageTag(!1,!1)},CustomerStatusUpdateMessage:{objectName:"RC:CsUpdate",msgTag:new e.MessageTag(!1,!1)},ReadReceiptMessage:{objectName:"RC:ReadNtf",msgTag:new e.MessageTag(!1,!1)}},t.MessageParams.AcceptMessage={objectName:"RC:VCAccept",msgTag:new e.MessageTag(!1,!1)},t.MessageParams.RingingMessage={objectName:"RC:VCRinging",msgTag:new e.MessageTag(!1,!1)},t.MessageParams.SummaryMessage={objectName:"RC:VCSummary",msgTag:new e.MessageTag(!1,!1)},t.MessageParams.HungupMessage={objectName:"RC:VCHangup",msgTag:new e.MessageTag(!1,!1)},t.MessageParams.InviteMessage={objectName:"RC:VCInvite",msgTag:new e.MessageTag(!1,!1)},t.MessageParams.MediaModifyMessage={objectName:"RC:VCModifyMedia",msgTag:new e.MessageTag(!1,!1)},t.MessageParams.MemberModifyMessage={objectName:"RC:VCModifyMem",msgTag:new e.MessageTag(!1,!1)},t.MessageType={TextMessage:"TextMessage",ImageMessage:"ImageMessage",DiscussionNotificationMessage:"DiscussionNotificationMessage",VoiceMessage:"VoiceMessage",RichContentMessage:"RichContentMessage",HandshakeMessage:"HandshakeMessage",UnknownMessage:"UnknownMessage",LocationMessage:"LocationMessage",InformationNotificationMessage:"InformationNotificationMessage",ContactNotificationMessage:"ContactNotificationMessage",ProfileNotificationMessage:"ProfileNotificationMessage",CommandNotificationMessage:"CommandNotificationMessage",CommandMessage:"CommandMessage",TypingStatusMessage:"TypingStatusMessage",ChangeModeResponseMessage:"ChangeModeResponseMessage",ChangeModeMessage:"ChangeModeMessage",EvaluateMessage:"EvaluateMessage",HandShakeMessage:"HandShakeMessage",HandShakeResponseMessage:"HandShakeResponseMessage",SuspendMessage:"SuspendMessage",TerminateMessage:"TerminateMessage",CustomerContact:"CustomerContact",CustomerStatusUpdateMessage:"CustomerStatusUpdateMessage",SyncReadStatusMessage:"SyncReadStatusMessage",ReadReceiptRequestMessage:"ReadReceiptRequestMessage",ReadReceiptResponseMessage:"ReadReceiptResponseMessage",FileMessage:"FileMessage",AcceptMessage:"AcceptMessage",RingingMessage:"RingingMessage",SummaryMessage:"SummaryMessage",HungupMessage:"HungupMessage",InviteMessage:"InviteMessage",MediaModifyMessage:"MediaModifyMessage",MemberModifyMessage:"MemberModifyMessage",JrmfReadPacketMessage:"JrmfReadPacketMessage",JrmfReadPacketOpenedMessage:"JrmfReadPacketOpenedMessage"},t.Conversation=t._dataAccessProvider.Conversation},t.connect=function(n,o,s){var r="navi",i=t._storageProvider;r=i.getItemKey(r);var a=i.getItem(r)||"",c=a.split(",")[0];(function(e){return/^\d{1,3}(\.\d{1,3}){3}(:\d*)?$/.test(e)})(c)&&i.removeItem("rongSDK"),e.CheckParam.getInstance().check(["string","object","string|null|object|global|undefined"],"connect",!0,arguments),t._dataAccessProvider.connect(n,o,s)},t.ready=function(n){if(function(){var t=!1,n=!1;return e.Bridge._client&&e.Bridge._client.channel&&(t=e.Bridge._client.channel.connectionStatus==e.ConnectionStatus.CONNECTING,n=e.Bridge._client.channel.connectionStatus==e.ConnectionStatus.CONNECTED),!(!n&&!t)}())return n(e.Bridge._client);var o=e.RongIMClient._memoryStore.callback||{onTokenIncorrect:function(){console.error("å†…éƒ¨é‡è¿ž, Token Error")},onError:function(e){console.error("å†…éƒ¨é‡è¿žå¤±è´¥ï¼Œé”™è¯¯ç : %d",e)}};t.reconnect({onSuccess:function(){e.Bridge._client.channel.connectionStatus=e.ConnectionStatus.CONNECTED,n(e.Bridge._client)},onTokenIncorrect:o.onTokenIncorrect,onError:o.onError})},t.initApp=function(e,n){t.init(e.appkey,e.dataAccessProvider,e.opts),t.connect(e.token,{onSuccess:function(e){n(t._instance,e)},onTokenIncorrect:function(){throw new Error("token expired")},onError:function(e){}})},t.reconnect=function(e){t._dataAccessProvider.reconnect(e)},t.registerMessageType=function(e,n,o,s){t._dataAccessProvider.registerMessageType(e,n,o,s),t.RegisterMessage[e].messageName=e,t.MessageType[e]=e,t.MessageParams[e]={objectName:n,msgTag:o}},t.setConnectionStatusListener=function(e){t._dataAccessProvider?t._dataAccessProvider.setConnectionStatusListener(e):t._memoryStore.listenerList.push(e)},t.setOnReceiveMessageListener=function(e){t._dataAccessProvider?t._dataAccessProvider.setOnReceiveMessageListener(e):t._memoryStore.listenerList.push(e)},t.prototype.logout=function(){this.clearCache(),t._dataAccessProvider.logout()},t.prototype.disconnect=function(){t._dataAccessProvider.disconnect()},t.prototype.startCustomService=function(n,o,s){if(n&&o){var r;r=void 0===s?new e.HandShakeMessage:new e.HandShakeMessage({groupid:s});var i=this;e.RongIMClient._memoryStore.custStore.isInit=!0,t.getInstance().sendMessage(e.ConversationType.CUSTOMER_SERVICE,n,r,{onSuccess:function(e){e.isBlack?(o.onError(),i.stopCustomeService(n,{onSuccess:function(){},onError:function(){}})):o.onSuccess()},onError:function(){o.onError()},onBefore:function(){}})}},t.prototype.stopCustomeService=function(n,o){if(n&&o){var s=t._memoryStore.custStore[n];if(s){var r=new e.SuspendMessage({sid:s.sid,uid:s.uid,pid:s.pid});this.sendCustMessage(n,r,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(){setTimeout(function(){o.onError()})}})}}},t.prototype.switchToHumanMode=function(n,o){if(n&&o){var s=t._memoryStore.custStore[n];if(s){var r=new e.ChangeModeMessage({sid:s.sid,uid:s.uid,pid:s.pid});this.sendCustMessage(n,r,o)}}},t.prototype.evaluateRebotCustomService=function(n,o,s,r){if(n&&r){var i=t._memoryStore.custStore[n];if(i){var a=new e.EvaluateMessage({sid:i.sid,uid:i.uid,pid:i.pid,isRobotResolved:o,sugest:s,type:0});this.sendCustMessage(n,a,r)}}},t.prototype.evaluateHumanCustomService=function(n,o,s,r){if(n&&r){var i=t._memoryStore.custStore[n];if(i){var a=new e.EvaluateMessage({sid:i.sid,uid:i.uid,pid:i.pid,humanValue:o,sugest:s,type:1});this.sendCustMessage(n,a,r)}}},t.prototype.sendCustMessage=function(n,o,s){t.getInstance().sendMessage(e.ConversationType.CUSTOMER_SERVICE,n,o,{onSuccess:function(e){s.onSuccess()},onError:function(){s.onError()},onBefore:function(){}})},t.prototype.getCurrentConnectionStatus=function(){return e.Bridge._client.channel.connectionStatus},t.prototype.getConnectionChannel=function(){return e.Transportations._TransportType==e.Socket.XHR_POLLING?e.ConnectionChannel.XHR_POLLING:e.Transportations._TransportType==e.Socket.WEBSOCKET?e.ConnectionChannel.WEBSOCKET:void 0},t.prototype.getStorageProvider=function(){return 1==t._memoryStore.providerType?"ServerDataProvider":"OtherDataProvider"},t.prototype.setFilterMessages=function(e){"[object Array]"==Object.prototype.toString.call(e)&&(t._memoryStore.filterMessages=e)},t.prototype.getAgoraDynamicKey=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"getAgoraDynamicKey",!1,arguments);var r=new Modules.VoipDynamicInput;r.setEngineType(n),r.setChannelName(o),t.bridge.queryMsg(32,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,s,"VoipDynamicOutput")},t.prototype.getCurrentUserId=function(){return e.Bridge._client.userId},t.prototype.getDeltaTime=function(){return t._dataAccessProvider.getDelaTime()},t.prototype.getMessage=function(e,n){t._dataAccessProvider.getMessage(e,n)},t.prototype.deleteLocalMessages=function(e,n,o,s){t._dataAccessProvider.removeLocalMessage(e,n,o,s)},t.prototype.updateMessage=function(e,n){t._dataAccessProvider.updateMessage(e,n)},t.prototype.clearMessages=function(e,n,o){t._dataAccessProvider.clearMessages(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearMessagesUnreadStatus=function(e,n,o){t._dataAccessProvider.updateMessages(e,n,"readStatus",null,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.deleteRemoteMessages=function(t,n,o,s){if(e.CheckParam.getInstance().check(["number","string","array","object"],"deleteRemoteMessages",!1,arguments),0==o.length)return void s.onError(e.ErrorCode.DELETE_MESSAGE_ID_IS_NULL);o.length>100&&(o.length=100),s.onSuccess(!0)},t.prototype.deleteMessages=function(e,n,o,s){t._dataAccessProvider.removeMessage(e,n,o,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){setTimeout(function(){s.onError(e)})}})},t.prototype.sendLocalMessage=function(n,o){e.CheckParam.getInstance().check(["object","object"],"sendLocalMessage",!1,arguments),t._dataAccessProvider.updateMessage(n),this.sendMessage(n.conversationType,n.targetId,n.content,o)},t.prototype.sendMessage=function(n,o,s,r,i,a,c,u){e.CheckParam.getInstance().check(["number","string","object","object","undefined|object|null|global|boolean","undefined|object|null|global|string","undefined|object|null|global|string","undefined|object|null|global|number"],"sendMessage",!1,arguments),t._dataAccessProvider.sendMessage(n,o,s,r,i,a,c,u)},t.prototype.sendReceiptResponse=function(e,n,o){t._dataAccessProvider.sendReceiptResponse(e,n,o)},t.prototype.sendTypingStatusMessage=function(e,n,o,s){t._dataAccessProvider.sendTypingStatusMessage(e,n,o,s)},t.prototype.sendStatusMessage=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.sendTextMessage=function(e,n,o,s){t._dataAccessProvider.sendTextMessage(e,n,o,s)},t.prototype.sendRecallMessage=function(e,n){t._dataAccessProvider.sendRecallMessage(e,n)},t.prototype.insertMessage=function(e,n,o,s,r){t._dataAccessProvider.addMessage(e,n,s,r)},t.prototype.getHistoryMessages=function(n,o,s,r,i,a,c){if(e.CheckParam.getInstance().check(["number","string","number|null|global|object","number","object","undefined|object|null|global|string","boolean|null|global|object"],"getHistoryMessages",!1,arguments),r>20)throw new Error("HistroyMessage count must be less than or equal to 20!");if(n.valueOf()<0)throw new Error("ConversationType must be greater than -1");t._dataAccessProvider.getHistoryMessages(n,o,s,r,i,a,c)},t.prototype.setMessageContent=function(e,n,o){t._dataAccessProvider.setMessageContent(e,n,o)},t.prototype.getRemoteHistoryMessages=function(n,o,s,r,i){return e.CheckParam.getInstance().check(["number","string","number|null|global|object","number","object"],"getRemoteHistoryMessages",!1,arguments),r>20?void i.onError(e.ErrorCode.RC_CONN_PROTO_VERSION_ERROR):n.valueOf()<0?void i.onError(e.ErrorCode.RC_CONN_PROTO_VERSION_ERROR):void t._dataAccessProvider.getRemoteHistoryMessages(n,o,s,r,i)},t.prototype.hasRemoteUnreadMessages=function(e,n){t._dataAccessProvider.hasRemoteUnreadMessages(e,n)},t.prototype.getTotalUnreadCount=function(e,n){t._dataAccessProvider.getTotalUnreadCount({onSuccess:function(t){setTimeout(function(){e.onSuccess(t)})},onError:function(t){setTimeout(function(){e.onError(t)})}},n)},t.prototype.getConversationUnreadCount=function(e,n){t._dataAccessProvider.getConversationUnreadCount(e,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(e){setTimeout(function(){n.onError(e)})}})},t.prototype.getUnreadCount=function(e,n,o){t._dataAccessProvider.getUnreadCount(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearUnreadCountByTimestamp=function(e,n,o,s){t._dataAccessProvider.clearUnreadCountByTimestamp(e,n,o,s)},t.prototype.clearUnreadCount=function(e,n,o){t._dataAccessProvider.clearUnreadCount(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearTotalUnreadCount=function(e){t._dataAccessProvider.clearTotalUnreadCount({onSuccess:function(t){setTimeout(function(){e.onSuccess(t)})},onError:function(t){setTimeout(function(){e.onError(t)})}})},t.prototype.clearLocalStorage=function(e){t._storageProvider.clearItem(),e()},t.prototype.setMessageExtra=function(e,n,o){t._dataAccessProvider.setMessageExtra(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.setMessageReceivedStatus=function(e,n,o){t._dataAccessProvider.setMessageReceivedStatus(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.setMessageStatus=function(e,n,o,s,r){t._dataAccessProvider.setMessageStatus(e,n,o,s,r)},t.prototype.setMessageSentStatus=function(e,n,o){t._dataAccessProvider.setMessageSentStatus(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearTextMessageDraft=function(n,o){e.CheckParam.getInstance().check(["number","string","object"],"clearTextMessageDraft",!1,arguments);var s="darf_"+n+"_"+o;return delete t._memoryStore[s],!0},t.prototype.getTextMessageDraft=function(n,o){if(e.CheckParam.getInstance().check(["number","string","object"],"getTextMessageDraft",!1,arguments),""==o||n<0)throw new Error("params error : "+e.ErrorCode.DRAF_GET_ERROR);var s="darf_"+n+"_"+o;return t._memoryStore[s]},t.prototype.saveTextMessageDraft=function(n,o,s){e.CheckParam.getInstance().check(["number","string","string","object"],"saveTextMessageDraft",!1,arguments);var r="darf_"+n+"_"+o;return t._memoryStore[r]=s,!0},t.prototype.searchConversationByContent=function(e,n,o){t._dataAccessProvider.searchConversationByContent(e,n,o)},t.prototype.searchMessageByContent=function(e,n,o,s,r,i,a){t._dataAccessProvider.searchMessageByContent(e,n,o,s,r,i,a)},t.prototype.clearCache=function(){t._dataAccessProvider.clearCache()},t.prototype.clearConversations=function(n){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];0==o.length&&(o=[e.ConversationType.CHATROOM,e.ConversationType.CUSTOMER_SERVICE,e.ConversationType.DISCUSSION,e.ConversationType.GROUP,e.ConversationType.PRIVATE,e.ConversationType.SYSTEM,e.ConversationType.PUBLIC_SERVICE,e.ConversationType.APP_PUBLIC_SERVICE]),t._dataAccessProvider.clearConversations(o,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(e){setTimeout(function(){n.onError(e)})}})},t.prototype.getConversation=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"getConversation",!1,arguments),t._dataAccessProvider.getConversation(n,o,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){setTimeout(function(){s.onError(e)})}})},t.prototype.pottingConversation=function(n){var o=this,s=!1;t._dataAccessProvider.getConversation(n.type,n.userId,{onSuccess:function(r){r?s=!0:r=new e.Conversation,r.conversationType=n.type,r.targetId=n.userId,r.latestMessage=e.MessageUtil.messageParser(n.msg),r.latestMessageId=r.latestMessage.messageId,r.objectName=r.latestMessage.objectName,r.receivedStatus=r.latestMessage.receivedStatus,r.receivedTime=r.latestMessage.receiveTime,r.sentStatus=r.latestMessage.sentStatus,r.sentTime=r.latestMessage.sentTime;var i=t._storageProvider.getItem("mentioneds_"+e.Bridge._client.userId+"_"+r.conversationType+"_"+r.targetId);if(i){var a=JSON.parse(i);r.mentionedMsg=a[n.type+"_"+n.userId]}if(!s)if(e.MessageUtil.supportLargeStorage()){var c=t._storageProvider.getItem("cu"+e.Bridge._client.userId+n.type+n.userId);r.unreadMessageCount=Number(c)}else r.unreadMessageCount=0;r.conversationType==e.ConversationType.DISCUSSION&&o.getDiscussion(n.userId,{onSuccess:function(e){r.conversationTitle=e.name},onError:function(e){}}),t._dataAccessProvider.addConversation(r,{onSuccess:function(e){}})},onError:function(e){}})},t.prototype.sortConversationList=function(e){for(var n=[],o=0,s=e.length;o<s;o++)if(e[o])if(e[o].isTop)n.push(e[o]),e.splice(o,1);else for(var r=0;r<s-o-1;r++)if(e[r].sentTime<e[r+1].sentTime){var i=e[r];e[r]=e[r+1],e[r+1]=i}return t._memoryStore.conversationList=n.concat(e)},t.prototype.getConversationList=function(n,o,s,r){e.CheckParam.getInstance().check(["object","null|array|object|global","number|undefined|null|object|global","boolean|undefined|null|object|global"],"getConversationList",!1,arguments);t._dataAccessProvider.getConversationList({onSuccess:function(e){o||t._dataAccessProvider?setTimeout(function(){n.onSuccess(e)}):setTimeout(function(){n.onSuccess(t._memoryStore.conversationList)})},onError:function(t){t===e.ErrorCode.TIMEOUT?n.onError(t):n.onSuccess([])}},o,s,r)},t.prototype.getRemoteConversationList=function(n,o,s,r){e.CheckParam.getInstance().check(["object","null|array|object|global","number|undefined|null|object|global","boolean|undefined|null|object|global"],"getRemoteConversationList",!1,arguments),t._dataAccessProvider.getRemoteConversationList(n,o,s,r)},t.prototype.updateConversation=function(e){return t._dataAccessProvider.updateConversation(e)},t.prototype.createConversation=function(t,n,o){e.CheckParam.getInstance().check(["number","string","string"],"createConversation",!1,arguments);var s=new e.Conversation;return s.targetId=n,s.conversationType=t,s.conversationTitle=o,s.latestMessage={},s.unreadMessageCount=0,s},t.prototype.removeConversation=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"removeConversation",!1,arguments),t._dataAccessProvider.removeConversation(n,o,s)},t.prototype.setConversationHidden=function(n,o,s){e.CheckParam.getInstance().check(["number","string","boolean"],"setConversationHidden",!1,arguments),t._dataAccessProvider.setConversationHidden(n,o,s)},t.prototype.setConversationToTop=function(n,o,s,r){e.CheckParam.getInstance().check(["number","string","boolean","object"],"setConversationToTop",!1,arguments),t._dataAccessProvider.setConversationToTop(n,o,s,{onSuccess:function(e){setTimeout(function(){r.onSuccess(e)})},onError:function(e){setTimeout(function(){r.onError(e)})}})},t.prototype.getConversationNotificationStatus=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.setConversationNotificationStatus=function(e,t,n,o){throw new Error("Not implemented yet")},t.prototype.getNotificationQuietHours=function(e){throw new Error("Not implemented yet")},t.prototype.removeNotificationQuietHours=function(e){throw new Error("Not implemented yet")},t.prototype.setNotificationQuietHours=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.addMemberToDiscussion=function(n,o,s){e.CheckParam.getInstance().check(["string","array","object"],"addMemberToDiscussion",!1,arguments),t._dataAccessProvider.addMemberToDiscussion(n,o,s)},t.prototype.createDiscussion=function(n,o,s){e.CheckParam.getInstance().check(["string","array","object"],"createDiscussion",!1,arguments),t._dataAccessProvider.createDiscussion(n,o,s)},t.prototype.getDiscussion=function(n,o){e.CheckParam.getInstance().check(["string","object"],"getDiscussion",!1,arguments),t._dataAccessProvider.getDiscussion(n,o)},t.prototype.quitDiscussion=function(n,o){e.CheckParam.getInstance().check(["string","object"],"quitDiscussion",!1,arguments),t._dataAccessProvider.quitDiscussion(n,o)},t.prototype.removeMemberFromDiscussion=function(n,o,s){e.CheckParam.getInstance().check(["string","string","object"],"removeMemberFromDiscussion",!1,arguments),t._dataAccessProvider.removeMemberFromDiscussion(n,o,s)},t.prototype.setDiscussionInviteStatus=function(n,o,s){e.CheckParam.getInstance().check(["string","number","object"],"setDiscussionInviteStatus",!1,arguments),t._dataAccessProvider.setDiscussionInviteStatus(n,o,s)},t.prototype.setDiscussionName=function(n,o,s){e.CheckParam.getInstance().check(["string","string","object"],"setDiscussionName",!1,arguments),t._dataAccessProvider.setDiscussionName(n,o,s)},t.prototype.joinGroup=function(n,o,s){e.CheckParam.getInstance().check(["string","string","object"],"joinGroup",!1,arguments),t._dataAccessProvider.joinGroup(n,o,s)},t.prototype.quitGroup=function(n,o){e.CheckParam.getInstance().check(["string","object"],"quitGroup",!1,arguments),t._dataAccessProvider.quitGroup(n,o)},t.prototype.syncGroup=function(n,o){e.CheckParam.getInstance().check(["array","object"],"syncGroup",!1,arguments),t._dataAccessProvider.syncGroup(n,o)},t.prototype.joinChatRoom=function(n,o,s){if(e.CheckParam.getInstance().check(["string","number","object"],"joinChatRoom",!1,arguments),""==n)return void setTimeout(function(){s.onError(e.ErrorCode.CHATROOM_ID_ISNULL)});t._dataAccessProvider.joinChatRoom(n,o,s)},t.prototype.setChatroomHisMessageTimestamp=function(n,o){e.CheckParam.getInstance().check(["string","number"],"setChatroomHisMessageTimestamp",!1,arguments),t._dataAccessProvider.setChatroomHisMessageTimestamp(n,o)},t.prototype.getChatRoomHistoryMessages=function(n,o,s,r){e.CheckParam.getInstance().check(["string","number","number","object"],"getChatRoomHistoryMessages",!1,arguments),t._dataAccessProvider.getChatRoomHistoryMessages(n,o,s,r)},t.prototype.getChatRoomInfo=function(n,o,s,r){e.CheckParam.getInstance().check(["string","number","number","object"],"getChatRoomInfo",!1,arguments),t._dataAccessProvider.getChatRoomInfo(n,o,s,r)},t.prototype.quitChatRoom=function(n,o){e.CheckParam.getInstance().check(["string","object"],"quitChatRoom",!1,arguments),t._dataAccessProvider.quitChatRoom(n,o)},t.prototype.getRemotePublicServiceList=function(n,o){if(t._memoryStore.depend.openMp){var s=new Modules.PullMpInput;o?s.setTime(o):s.setTime(0),s.setMpid(""),t.bridge.queryMsg(28,e.MessageUtil.ArrayForm(s.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){t._memoryStore.publicServiceMap.publicServiceList.length=0,t._memoryStore.publicServiceMap.publicServiceList=e,n.onSuccess(e)},onError:function(){}},"PullMpOutput")}},t.prototype.getPublicServiceList=function(n){t._memoryStore.depend.openMp&&(e.CheckParam.getInstance().check(["object"],"getPublicServiceList",!1,arguments),this.getRemotePublicServiceList(n))},t.prototype.getPublicServiceProfile=function(n,o,s){if(t._memoryStore.depend.openMp){e.CheckParam.getInstance().check(["number","string","object"],"getPublicServiceProfile",!1,arguments);var r=t._memoryStore.publicServiceMap.get(n,o);s.onSuccess(r)}},t.prototype.pottingPublicSearchType=function(e,n){if(t._memoryStore.depend.openMp){var o=0;return 0==e?(o|=3,o|=0==n?12:48):1==e?(o|=1,o|=0==n?8:32):(o|=2,o|=0==e?4:16),o}},t.prototype.searchPublicService=function(n,o,s){if(t._memoryStore.depend.openMp){e.CheckParam.getInstance().check(["number","string","object"],"searchPublicService",!1,arguments);var r=new Modules.SearchMpInput;r.setType(this.pottingPublicSearchType(0,n)),r.setId(o),t.bridge.queryMsg(29,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,s,"SearchMpOutput")}},t.prototype.searchPublicServiceByType=function(n,o,s,r){if(t._memoryStore.depend.openMp){e.CheckParam.getInstance().check(["number","number","string","object"],"searchPublicServiceByType",!1,arguments);var i=n==e.ConversationType.APP_PUBLIC_SERVICE?2:1,a=new Modules.SearchMpInput;a.setType(this.pottingPublicSearchType(i,o)),a.setId(s),t.bridge.queryMsg(29,e.MessageUtil.ArrayForm(a.toArrayBuffer()),e.Bridge._client.userId,r,"SearchMpOutput")}},t.prototype.subscribePublicService=function(n,o,s){if(t._memoryStore.depend.openMp){e.CheckParam.getInstance().check(["number","string","object"],"subscribePublicService",!1,arguments);var r=new Modules.MPFollowInput,i=this,a=n==e.ConversationType.APP_PUBLIC_SERVICE?"mcFollow":"mpFollow";r.setId(o),t.bridge.queryMsg(a,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(){i.getRemotePublicServiceList({onSuccess:function(){},onError:function(){}}),s.onSuccess()},onError:function(e){s.onError(e)}},"MPFollowOutput")}},t.prototype.unsubscribePublicService=function(n,o,s){if(t._memoryStore.depend.openMp){e.CheckParam.getInstance().check(["number","string","object"],"unsubscribePublicService",!1,arguments);var r=new Modules.MPFollowInput,i=n==e.ConversationType.APP_PUBLIC_SERVICE?"mcUnFollow":"mpUnFollow";r.setId(o),t.bridge.queryMsg(i,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(){t._memoryStore.publicServiceMap.remove(n,o),s.onSuccess()},onError:function(e){s.onError(e)}},"MPFollowOutput")}},t.prototype.addToBlacklist=function(n,o){e.CheckParam.getInstance().check(["string","object"],"addToBlacklist",!1,arguments),t._dataAccessProvider.addToBlacklist(n,o)},t.prototype.getBlacklist=function(n){e.CheckParam.getInstance().check(["object"],"getBlacklist",!1,arguments),t._dataAccessProvider.getBlacklist(n)},t.prototype.getBlacklistStatus=function(n,o){e.CheckParam.getInstance().check(["string","object"],"getBlacklistStatus",!1,arguments),t._dataAccessProvider.getBlacklistStatus(n,o)},t.prototype.removeFromBlacklist=function(n,o){e.CheckParam.getInstance().check(["string","object"],"removeFromBlacklist",!1,arguments),t._dataAccessProvider.removeFromBlacklist(n,o)},t.prototype.getFileToken=function(n,o){e.CheckParam.getInstance().check(["number","object"],"getQnTkn",!1,arguments),t._dataAccessProvider.getFileToken(n,o)},t.prototype.getFileUrl=function(n,o,s,r){e.CheckParam.getInstance().check(["number","string","string|global|object|null","object"],"getQnTkn",!1,arguments),t._dataAccessProvider.getFileUrl(n,o,s,r)},t.prototype.addRealTimeLocationListener=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.getRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.getRealTimeLocationCurrentState=function(e,t){throw new Error("Not implemented yet")},t.prototype.getRealTimeLocationParticipants=function(e,t){throw new Error("Not implemented yet")},t.prototype.joinRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.quitRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.startRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.updateRealTimeLocationStatus=function(e,t,n,o){throw new Error("Not implemented yet")},t.prototype.startCall=function(n,o,s,r,i,a){e.CheckParam.getInstance().check(["number","string","array","number","string","object"],"startCall",!1,arguments),t._memoryStore.voipStategy?t._voipProvider.startCall(n,o,s,r,i,a):a.onError(e.ErrorCode.VOIP_NOT_AVALIABLE)},t.prototype.joinCall=function(n,o){e.CheckParam.getInstance().check(["number","object"],"joinCall",!1,arguments),t._memoryStore.voipStategy?t._voipProvider.joinCall(n,o):o.onError(e.ErrorCode.VOIP_NOT_AVALIABLE)},t.prototype.hungupCall=function(n,o,s){e.CheckParam.getInstance().check(["number","string","number"],"hungupCall",!1,arguments),t._memoryStore.voipStategy&&t._voipProvider.hungupCall(n,o,s)},t.prototype.changeMediaType=function(n,o,s,r){e.CheckParam.getInstance().check(["number","string","number","object"],"changeMediaType",!1,arguments),t._memoryStore.voipStategy?t._voipProvider.changeMediaType(n,o,s,r):r.onError(e.ErrorCode.VOIP_NOT_AVALIABLE)},t.prototype.getUnreadMentionedMessages=function(e,n){return t._dataAccessProvider.getUnreadMentionedMessages(e,n)},t.prototype.clearListeners=function(){t._dataAccessProvider.clearListeners()},t.prototype.getUserStatus=function(e,n){t._dataAccessProvider.getUserStatus(e,n)},t.prototype.setUserStatus=function(e,n){t._dataAccessProvider.setUserStatus(e,n)},t.prototype.subscribeUserStatus=function(e,n){t._dataAccessProvider.subscribeUserStatus(e,n)},t.prototype.setOnReceiveStatusListener=function(e){t._dataAccessProvider.setOnReceiveStatusListener(e)},t.MessageType={},t.RegisterMessage={},t._memoryStore={listenerList:[]},t.isNotPullMsg=!1,t}();e.RongIMClient=t}(RongIMLib),function(e){!function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(e.Qos||(e.Qos={}));var t=e.Qos;!function(e){e[e.CONNECT=1]="CONNECT",e[e.CONNACK=2]="CONNACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUBACK=4]="PUBACK",e[e.QUERY=5]="QUERY",e[e.QUERYACK=6]="QUERYACK",e[e.QUERYCON=7]="QUERYCON",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUBACK=9]="SUBACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUBACK=11]="UNSUBACK",e[e.PINGREQ=12]="PINGREQ",e[e.PINGRESP=13]="PINGRESP",e[e.DISCONNECT=14]="DISCONNECT"}(e.Type||(e.Type={}));var n=(e.Type,["invtDiz","crDiz","qnUrl","userInf","dizInf","userInf","joinGrp","quitDiz","exitGrp","evctDiz",["","ppMsgP","pdMsgP","pgMsgP","chatMsg","pcMsgP","","pmcMsgN","pmpMsgN"],"pdOpen","rename","uGcmpr","qnTkn","destroyChrm","createChrm","exitChrm","queryChrm","joinChrm","pGrps","addBlack","rmBlack","getBlack","blackStat","addRelation","qryRelation","delRelation","pullMp","schMp","qnTkn","qnUrl","qryVoipK","delMsg","qryCHMsg"]),o=function(){function t(n,o,r){this.connectionStatus=-1,this.delOnChangedCount=0;var a=e.RongIMClient._memoryStore.depend.cmp;if(this.url=a+"/websocket?appId="+r.appId+"&token="+encodeURIComponent(r.token)+"&sdkVer="+r.sdkVer+"&apiVer="+r.apiVer,this.self=r,this.socket=s.getInstance().createServer(),this.socket.connect(this.url,o),!("object"==_typeof(t._ConnectionStatusListener)&&"onChanged"in t._ConnectionStatusListener))throw new Error("setConnectStatusListener:Parameter format is incorrect");var c=this;c.socket.on("StatusChanged",function(n){if(c.connectionStatus===e.ConnectionStatus.DISCONNECTED&&n===e.ConnectionStatus.NETWORK_UNAVAILABLE)return void(c.connectionStatus=n);if(c.connectionStatus=n,n===e.ConnectionStatus.NETWORK_UNAVAILABLE){var o=e.RongIMClient._storageProvider.getItemKey("navi"),s=e.RongIMClient._storageProvider.getItem(o),a=s.split(",")[0].split(":")[1];if(a&&a.length<4||e.RongIMClient._storageProvider.setItem("rongSDK",""),!e.RongIMClient._memoryStore.depend.isPolling&&a&&a.length<4){i._client.handler.connectCallback.pauseTimer();var o=e.RongIMClient._storageProvider.getItemKey("navi"),u=e.RongIMClient._storageProvider.getItem("RongBackupServer");if(u){var g=u.split(",");if(g.length<2)throw new Error("navi server is empty,postion:StatusChanged");e.RongIMClient._storageProvider.setItem(o,e.RongIMClient._storageProvider.getItem("RongBackupServer"));var p=e.Bridge._client.channel.socket.currentURL;i._client.channel.socket.currentURL=g[0]+p.substring(p.indexOf("/"),p.length),i._client.channel&&i._client.channel.connectionStatus!=e.ConnectionStatus.CONNECTED&&i._client.channel.connectionStatus!=e.ConnectionStatus.CONNECTING&&e.RongIMClient.connect(e.RongIMClient._memoryStore.token,e.RongIMClient._memoryStore.callback)}}}if(n===e.ConnectionStatus.DISCONNECTED&&!e.RongIMClient._memoryStore.otherDevice)return t._ConnectionStatusListener.onChanged(e.ConnectionStatus.DISCONNECTED),void r.clearHeartbeat();n===e.ConnectionStatus.DISCONNECTED&&e.RongIMClient._memoryStore.otherDevice||(t._ConnectionStatusListener.onChanged(n),e.RongIMClient._memoryStore.otherDevice&&(c.delOnChangedCount>5&&delete t._ConnectionStatusListener.onChanged,c.delOnChangedCount++))}),this.socket.on("message",r.handler.handleMessage),this.socket.on("disconnect",function(e){r.channel.socket.fire("StatusChanged",e||2)})}return t.prototype.writeAndFlush=function(e){this.socket.send(e)},t.prototype.reconnect=function(t){e.MessageIdHandler.clearMessageId(),this.socket=this.socket.reconnect(),t&&(this.self.reconnectObj=t)},t.prototype.disconnect=function(e){this.socket.disconnect(e)},t}();e.Channel=o;var s=function(){function t(){this.socket=null,this._events={}}return t.getInstance=function(){return new t},t.prototype.connect=function(t,n){return this.socket&&(t&&(e.RongIMClient._storageProvider.setItem("rongSDK",this.checkTransport()),this.on("connect",n||new Function)),t&&(this.currentURL=t),this.socket.createTransport(t)),this},t.prototype.createServer=function(){var e=this.getTransport(this.checkTransport());if(null===e)throw new Error("the channel was not supported");return e},t.prototype.getTransport=function(t){var n=e.RongIMClient._memoryStore.depend.isPolling;return this.socket=n?new e.PollingTransportation(this):new e.SocketTransportation(this),this},t.prototype.send=function(t){if(this.socket){e.RongIMClient._memoryStore.depend.isPolling?this.socket.send(this._encode(t)):this.socket.send(t)}},t.prototype.onMessage=function(e){this.fire("message",e)},t.prototype.disconnect=function(t){return e.ConnectionStatus.KICKED_OFFLINE_BY_OTHER_CLIENT===t&&(e.RongIMClient._memoryStore.otherDevice=!0),this.socket.disconnect(t),this.fire("disconnect",t),this},t.prototype.reconnect=function(){if(this.currentURL&&e.RongIMClient._storageProvider.getItem("rongSDK"))return this.connect(this.currentURL,null);throw new Error("reconnect:no have URL")},t.prototype.checkTransport=function(){return e.RongIMClient._memoryStore.depend.isPolling&&(e.Transportations._TransportType=t.XHR_POLLING),e.Transportations._TransportType},t.prototype.fire=function(e,t){if(e in this._events)for(var n=0,o=this._events[e].length;n<o;n++)this._events[e][n](t);return this},t.prototype.on=function(t,n){return"function"==typeof n&&t?(t in this._events?-1==e.MessageUtil.indexOf(this._events,n)&&this._events[t].push(n):this._events[t]=[n],this):this},t.prototype.removeEvent=function(e,t){if(e in this._events)for(var n=0,o=this._events[e].length;n<o;n++)this._events[e][n]==t&&this._events[e].splice(n,1);return this},t.prototype._encode=function(t){var n="?messageid="+t.getMessageId()+"&header="+t.getHeaderFlag()+"&sessionid="+e.RongIMClient._storageProvider.getItem("sId"+e.Navigation.Endpoint.userId);return/(PubAckMessage|QueryConMessage)/.test(t._name)||(n+="&topic="+t.getTopic()+"&targetid="+(t.getTargetId()||"")),{url:n,data:"getData"in t?t.getData():""}},t.WEBSOCKET="websocket",t}();e.Socket=s;var r=function(){function n(e,t){this.timeoutMillis=1e5,this.timeout_=0,this.sdkVer="2.3.1",this.apiVer=Math.floor(1e6*Math.random()),this.channel=null,this.handler=null,this.userId="",this.reconnectObj={},this.heartbeat=0,this.pullMsgHearbeat=0,this.chatroomId="",this.SyncTimeQueue=[],this.cacheMessageIds=[],this.token=e,this.appId=t,this.SyncTimeQueue.state="complete"}return n.prototype.resumeTimer=function(){this.timeout_||(this.timeout_=setTimeout(function(){if(this.timeout_){try{this.channel.disconnect()}catch(e){throw new Error(e)}clearTimeout(this.timeout_),this.timeout_=0,this.channel.reconnect(),this.channel.socket.fire("StatusChanged",5)}},this.timeoutMillis))},n.prototype.pauseTimer=function(){this.timeout_&&(clearTimeout(this.timeout_),this.timeout_=0)},n.prototype.connect=function(t){e.Transportations._TransportType,s.WEBSOCKET,this.handler=new a(this),this.handler.setConnectCallback(t);var n=this;this.channel=new o(e.Navigation.Endpoint,function(){e.Transportations._TransportType==s.WEBSOCKET&&n.keepLive()},this),this.channel.socket.fire("StatusChanged",1)},n.prototype.checkSocket=function(t){this.channel.writeAndFlush(new e.PingReqMessage);var n=setInterval(function(){e.RongIMClient._memoryStore.isFirstPingMsg?o>15&&(clearInterval(n),t.onError()):(t.onSuccess(),clearInterval(n)),o++},200),o=0},n.prototype.keepLive=function(){this.heartbeat>0&&clearInterval(this.heartbeat);var t=this;t.heartbeat=setInterval(function(){t.resumeTimer(),t.channel.writeAndFlush(new e.PingReqMessage)},3e4),t.pullMsgHearbeat>0&&clearInterval(t.pullMsgHearbeat),t.pullMsgHearbeat=setInterval(function(){t.syncTime(!0,void 0,void 0,!1)},18e4)},n.prototype.clearHeartbeat=function(){clearInterval(this.heartbeat),this.heartbeat=0,this.pauseTimer(),clearInterval(this.pullMsgHearbeat),this.pullMsgHearbeat=0},n.prototype.publishMessage=function(n,o,s,r,i){e.RongIMClient.ready(function(a){var c=e.MessageIdHandler.messageIdPlus(a.channel.reconnect);if(c){var u=new e.PublishMessage(n,o,s);u.setMessageId(c),r?(u.setQos(t.AT_LEAST_ONCE),a.handler.putCallback(new e.PublishCallback(r.onSuccess,r.onError),u.getMessageId(),i)):u.setQos(t.AT_MOST_ONCE),a.channel.writeAndFlush(u)}})},n.prototype.queryMessage=function(t,o,s,r,i,a){e.RongIMClient.ready(function(c){if("userInf"==t&&n.userInfoMapping[s])return void i.onSuccess(n.userInfoMapping[s]);var u=e.MessageIdHandler.messageIdPlus(c.channel.reconnect);if(u){var g=new e.QueryMessage(t,o,s);g.setMessageId(u),g.setQos(r),c.handler.putCallback(new e.QueryCallback(i.onSuccess,i.onError),g.getMessageId(),a),c.channel.writeAndFlush(g)}})},n.prototype.invoke=function(n,o,s){var r,a,c,u,g=this,p=this.SyncTimeQueue.shift();if(void 0!=p){this.SyncTimeQueue.state="pending";var d=e.MessageUtil.getSyncTime();if(2!=p.type){r=d.received,a=new Modules.SyncRequestMsg,a.setIspolling(!1),c="pullMsg",u=this.userId;var l=d.send;a.setSendBoxSyncTime(l)}else if(u=p.chrmId||g.chatroomId,r=e.RongIMClient._memoryStore.lastReadTime.get(u+i._client.userId+"CST")||0,a=new Modules.ChrmPullMsg,a.setCount(0),c="chrmPull",!u)throw new Error("syncTime:Received messages of chatroom but was not init");if(p.pulltime<=r)return this.SyncTimeQueue.state="complete",void this.invoke(n,u);n&&"setIsPullSend"in a&&a.setIsPullSend(!0),a.setSyncTime(r);var f=function(e){for(var t=!1,n=0,o=g.cacheMessageIds.length;n<o;n++){if(g.cacheMessageIds[n]==e){t=!0;break}}return t};this.queryMessage(c,e.MessageUtil.ArrayForm(a.toArrayBuffer()),u,t.AT_LEAST_ONCE,{onSuccess:function(t){var o=e.MessageUtil.int64ToTimestamp(t.syncTime),r=u;"chrmPull"==c&&(r+=i._client.userId+"CST",e.RongIMClient._memoryStore.lastReadTime.set(r,o));for(var a=t.list,p=a.length,d=0,l=p;d<p;d++)if(!f(a[d].msgId)){i._client.handler.onReceived(a[d],void 0,s,--l);var h=g.cacheMessageIds.unshift(a[d].msgId);h>200&&(g.cacheMessageIds.length=180)}if(p<=200&&"pullMsg"==c){var m=e.RongIMClient,M=m._dataAccessProvider.Conversation,I=m._memoryStore.conversationList;M._notify(I)}s&&(e.RongIMClient._memoryStore.isSyncRemoteConverList=!0),g.SyncTimeQueue.state="complete",g.invoke(n,u)},onError:function(e){g.SyncTimeQueue.state="complete",g.invoke(n,u)}},"DownStreamMessages")}},n.prototype.syncTime=function(e,t,n,o){this.SyncTimeQueue.push({type:e,chrmId:n,pulltime:t}),1==this.SyncTimeQueue.length&&"complete"==this.SyncTimeQueue.state&&this.invoke(!e,n,o)},n.prototype.__init=function(t){this.channel=new o(e.Navigation.Endpoint,t,this)},n.userInfoMapping={},n}();e.Client=r;var i=function(){function s(){}return s.getInstance=function(){return new s},s.prototype.connect=function(t,n,o){return e.RongIMClient._memoryStore.hasModules=!1,s._client=(new e.Navigation).connect(t,n,o),s._client},s.prototype.setListener=function(e){"object"==(void 0===e?"undefined":_typeof(e))&&("function"==typeof e.onChanged?o._ConnectionStatusListener=e:"function"==typeof e.onReceived&&(o._ReceiveMessageListener=e))},s.prototype.reconnect=function(e){s._client.channel.reconnect(e)},s.prototype.disconnect=function(){s._client.clearHeartbeat(),s._client.channel.disconnect(2)},s.prototype.queryMsg=function(e,o,r,i,a){"string"!=typeof e&&(e=n[e]),s._client.queryMessage(e,o,r,t.AT_MOST_ONCE,i,a)},s.prototype.pubMsg=function(t,o,r,i,a,c){"number"==typeof c?c==e.MethodType.CUSTOMER_SERVICE?s._client.publishMessage("pcuMsgP",o,r,i,a):c==e.MethodType.RECALL&&s._client.publishMessage("recallMsg",o,r,i,a):s._client.publishMessage(n[10][t],o,r,i,a)},s}();e.Bridge=i;var a=function(){function t(e){if(this.map={},this.connectCallback=null,!o._ReceiveMessageListener)throw new Error("please set onReceiveMessageListener");this._onReceived=o._ReceiveMessageListener.onReceived,this._client=e,this.syncMsgMap=new Object}return t.prototype.putCallback=function(e,t,n){var o={Callback:e,Message:n};o.Callback.resumeTimer(),this.map[t]=o},t.prototype.setConnectCallback=function(t){t&&(this.connectCallback=new e.ConnectAck(t.onSuccess,t.onError,this._client),this.connectCallback.resumeTimer())},t.prototype.onReceived=function(t,n,o,s){var r,a;if("PublishMessage"!=t._name)r=t;else{if("s_ntf"==t.getTopic())return r=Modules.NotifyMsg.decode(t.getData()),void this._client.syncTime(r.type,e.MessageUtil.int64ToTimestamp(r.time),r.chrmId);if("s_msg"==t.getTopic()){r=Modules.DownStreamMessage.decode(t.getData());e.MessageUtil.int64ToTimestamp(r.dataTime)}else{if(i._client.sdkVer&&"1.0.0"==i._client.sdkVer)return;r=Modules.UpStreamMessage.decode(t.getData());var c=t.getTopic(),u=c.substr(0,2);"pp"==u?r.type=1:"pd"==u?r.type=2:"pg"==u?r.type=3:"ch"==u?r.type=4:"pc"==u&&(r.type=5),r.groupId=t.getTargetId(),r.fromUserId=this._client.userId,r.dataTime=Date.parse((new Date).toString())}if(!r)return}if(a=e.MessageUtil.messageParser(r,this._onReceived,o),n&&(a.messageUId=n.getMessageUId(),a.sentTime=n.getTimestamp()),null!==a){var g=e.RongIMClient.MessageParams[a.messageType].msgTag.getMessageTag();3!=g&&1!=g||e.MessageUtil.updateSyncTime(a),3==g&&e.RongIMClient._dataAccessProvider.getConversation(a.conversationType,a.targetId,{onSuccess:function(t){if(t||(t=e.RongIMClient.getInstance().createConversation(a.conversationType,a.targetId,"")),a.messageDirection==e.MessageDirection.RECEIVE&&64==(64&r.status)){var n=e.RongIMClient._storageProvider.getItem("mentioneds_"+i._client.userId+"_"+a.conversationType+"_"+a.targetId),s=a.conversationType+"_"+a.targetId,c={};if(a.content&&a.content.mentionedInfo&&(c[s]={uid:a.messageUId,time:a.sentTime,mentionedInfo:a.content.mentionedInfo},e.RongIMClient._storageProvider.setItem("mentioneds_"+i._client.userId+"_"+a.conversationType+"_"+a.targetId,JSON.stringify(c)),n=JSON.stringify(c)),n){var c=JSON.parse(n);t.mentionedMsg=c[s]}}if(0!=t.conversationType&&a.senderUserId!=i._client.userId&&a.receivedStatus!=e.ReceivedStatus.RETRIEVED&&a.messageType!=e.RongIMClient.MessageType.ReadReceiptRequestMessage&&a.messageType!=e.RongIMClient.MessageType.ReadReceiptResponseMessage&&(t.unreadMessageCount=t.unreadMessageCount+1,e.MessageUtil.supportLargeStorage())){var u=e.RongIMClient._storageProvider.getItem("cu"+i._client.userId+t.conversationType+t.targetId);e.RongIMClient._storageProvider.setItem("cu"+i._client.userId+t.conversationType+a.targetId,Number(u)+1)}t.receivedTime=(new Date).getTime(),t.receivedStatus=a.receivedStatus,t.senderUserId=a.sendUserId,t.notificationStatus=e.ConversationNotificationStatus.DO_NOT_DISTURB,t.latestMessageId=a.messageId,t.latestMessage=a,t.sentTime=a.sentTime,e.RongIMClient._dataAccessProvider.addConversation(t,{onSuccess:function(t){if(!o){var n=e.RongIMClient,s=n._dataAccessProvider.Conversation,r=n._memoryStore.conversationList;s._notify(r)}},onError:function(){}})},onError:function(e){}});var p=new Date,d=p.getMonth()+1,l=p.getFullYear()+"/"+(1==d.toString().length?"0"+d:d)+"/"+p.getDate(),f=new Date(l).getTime()-a.sentTime<0;if(e.MessageUtil.supportLargeStorage()&&a.messageType===e.RongIMClient.MessageType.ReadReceiptRequestMessage&&f&&a.messageDirection==e.MessageDirection.SEND){var h=i._client.userId+a.content.messageUId+"SENT";e.RongIMClient._storageProvider.setItem(h,JSON.stringify({count:0,dealtime:a.sentTime,userIds:{}}))}else if(e.MessageUtil.supportLargeStorage()&&a.messageType===e.RongIMClient.MessageType.ReadReceiptRequestMessage&&f){var m=i._client.userId+a.conversationType+a.targetId+"RECEIVED",M=JSON.parse(e.RongIMClient._storageProvider.getItem(m));if(M)if(a.senderUserId in M){if(!M[a.senderUserId].uIds||!M[a.senderUserId].uIds||-1!=M[a.senderUserId].uIds.indexOf(a.content.messageUId))return;new Date(l).getTime()-M[a.senderUserId].dealtime<0||(M[a.senderUserId].uIds.length=0),M[a.senderUserId].uIds.push(a.content.messageUId),M[a.senderUserId].dealtime=a.sentTime,M[a.senderUserId].isResponse=!1,e.RongIMClient._storageProvider.setItem(m,JSON.stringify(M))}else{var I={uIds:[a.content.messageUId],dealtime:a.sentTime,isResponse:!1};M[a.senderUserId]=I,e.RongIMClient._storageProvider.setItem(m,JSON.stringify(M))}else{var C={};C[a.senderUserId]={uIds:[a.content.messageUId],dealtime:a.sentTime,isResponse:!1},e.RongIMClient._storageProvider.setItem(m,JSON.stringify(C))}}if(e.MessageUtil.supportLargeStorage()&&a.messageType===e.RongIMClient.MessageType.ReadReceiptResponseMessage&&f){var y,R=a.content,_=R.receiptMessageDic[i._client.userId],h="";if(a.receiptResponse||(a.receiptResponse={}),_){for(var S=[],T=0,E=_.length;T<E;T++)h=i._client.userId+_[T]+"SENT",!(y=JSON.parse(e.RongIMClient._storageProvider.getItem(h)))||a.senderUserId in y.userIds||(new Date(l).getTime()-y.dealtime>0?e.RongIMClient._storageProvider.removeItem(h):(S.push(_[T]),y.count+=1,y.userIds[a.senderUserId]=a.sentTime,a.receiptResponse[_[T]]=y.count,e.RongIMClient._storageProvider.setItem(h,JSON.stringify(y))));R.receiptMessageDic[i._client.userId]=S,a.content=R}}var v=this;if(e.RongIMClient._voipProvider&&["AcceptMessage","RingingMessage","HungupMessage","InviteMessage","MediaModifyMessage","MemberModifyMessage"].indexOf(a.messageType)>-1)e.RongIMClient._voipProvider.onReceived(a);else{var N=s||0;e.RongIMClient._dataAccessProvider.addMessage(a.conversationType,a.targetId,a,{onSuccess:function(e){v._onReceived(e,N)},onError:function(e){v._onReceived(a,N)}})}}},t.prototype.handleMessage=function(t){if(t)switch(t._name){case"ConnAckMessage":i._client.handler.connectCallback.process(t.getStatus(),t.getUserId(),t.getTimestamp());break;case"PublishMessage":t.getSyncMsg()||0==t.getQos()||i._client.channel.writeAndFlush(new e.PubAckMessage(t.getMessageId())),t.getSyncMsg()&&!e.RongIMClient._memoryStore.depend.isPolling?i._client.handler.syncMsgMap[t.getMessageId()]=t:i._client.handler.onReceived(t);break;case"QueryAckMessage":0!=t.getQos()&&i._client.channel.writeAndFlush(new e.QueryConMessage(t.getMessageId()));var n=i._client.handler.map[t.getMessageId()];n&&(n.Callback.process(t.getStatus(),t.getData(),t.getDate(),n.Message),delete i._client.handler.map[t.getMessageId()]);break;case"PubAckMessage":var o=i._client.handler.map[t.getMessageId()];o?(o.Callback.process(t.getStatus()||0,t.getMessageUId(),t.getTimestamp(),o.Message,t.getMessageId()),delete i._client.handler.map[t.getMessageId()]):(i._client.handler.onReceived(i._client.handler.syncMsgMap[t.messageId],t),delete i._client.handler.syncMsgMap[t.getMessageId()]);break;case"PingRespMessage":e.RongIMClient._memoryStore.isFirstPingMsg?e.RongIMClient._memoryStore.isFirstPingMsg=!1:i._client.pauseTimer();break;case"DisconnectMessage":i._client.channel.disconnect(t.getStatus())}},t}();e.MessageHandler=a}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(e){this.timeout=null,this.onError=null,e&&"number"==typeof e?this.timeoutMillis=e:(this.timeoutMillis=3e4,this.onError=e)}return t.prototype.resumeTimer=function(){var e=this;this.timeoutMillis>0&&!this.timeout&&(this.timeout=setTimeout(function(){e.readTimeOut(!0)},this.timeoutMillis))},t.prototype.pauseTimer=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t.prototype.readTimeOut=function(t){t&&this.onError?this.onError(e.ErrorCode.TIMEOUT):this.pauseTimer()},t}();e.MessageCallback=t;var n=function(){function t(){this.publicServiceList=[]}return t.getInstance=function(){return new t},t.prototype.pottingProfile=function(t){var n;this.profile=new e.PublicServiceProfile,n=JSON.parse(t.extra),this.profile.isGlobal=n.isGlobal,this.profile.introduction=n.introduction,this.profile.menu=n.menu,this.profile.hasFollowed=n.follow,this.profile.publicServiceId=t.mpid,this.profile.name=t.name,this.profile.portraitUri=t.portraitUrl,this.profile.conversationType="mc"==t.type?e.ConversationType.APP_PUBLIC_SERVICE:e.ConversationType.PUBLIC_SERVICE,this.publicServiceList.push(this.profile)},t.prototype.mapping=function(t,n){switch(n){case"GetUserInfoOutput":return new e.UserInfo(t.userId,t.userName,t.userPortrait);case"GetQNupTokenOutput":return{deadline:e.MessageUtil.int64ToTimestamp(t.deadline),token:t.token};case"GetQNdownloadUrlOutput":return{downloadUrl:t.downloadUrl};case"CreateDiscussionOutput":return t.id;case"ChannelInfoOutput":var o=new e.Discussion;return o.creatorId=t.adminUserId,o.id=t.channelId,o.memberIdList=t.firstTenUserIds,o.name=t.channelName,o.isOpen=t.openStatus,o;case"GroupHashOutput":return t.result;case"QueryBlackListOutput":return t.userIds;case"SearchMpOutput":case"PullMpOutput":if(t.info){var s=this;Array.forEach(t.info,function(e){setTimeout(s.pottingProfile(e),100)})}return this.publicServiceList;default:return t}},t}();e.CallbackMapping=n;var o=function(n){function o(e,t){n.call(this,t),this._cb=e,this._timeout=t}return __extends(o,n),o.prototype.process=function(t,n,o,s,r){this.readTimeOut(),0==t?(s&&(s.setSentStatus=t),e.MessageUtil.updateSyncTime({messageDirection:e.MessageDirection.SEND,sentTime:o}),e.RongIMClient._memoryStore.lastReadTime.get(e.Bridge._client.userId,o),this._cb({messageUId:n,timestamp:o,messageId:r})):this._timeout(t)},o.prototype.readTimeOut=function(e){t.prototype.readTimeOut.call(this,e)},o}(t);e.PublishCallback=o;var s=function(o){function s(e,t){o.call(this,t),this._cb=e,this._timeout=t}return __extends(s,o),s.prototype.process=function(t,o,s,r){if(this.readTimeOut(),r&&o&&0==t){try{o=n.getInstance().mapping(Modules[r].decode(o),r)}catch(t){return void this._timeout(e.ErrorCode.UNKNOWN)}"GetUserInfoOutput"==r&&(e.Client.userInfoMapping[o.userId]=o),this._cb(o)}else t>0?this._timeout(t):this._cb(t)},s.prototype.readTimeOut=function(e){t.prototype.readTimeOut.call(this,e)},s}(t);e.QueryCallback=s;var r=function(n){function o(e,t,o){n.call(this,t),this._client=o,this._cb=e,this._timeout=t}return __extends(o,n),o.prototype.process=function(t,n,o){this.readTimeOut();var s=this;if(0==t){if(s._client.userId=n,this._client.reconnectObj.onSuccess)this._client.reconnectObj.onSuccess(n),delete this._client.reconnectObj.onSuccess;else{s._cb(n);var r=e.RongIMClient,i=r._memoryStore.depend,a=i.maxConversationCount;r._dataAccessProvider.getRemoteConversationList({onSuccess:function(e){r._dataAccessProvider.Conversation._notify(e)},onError:function(e){console.log("å†…éƒ¨èŽ·å–åˆ—è¡¨å¤±è´¥: %d",e)}},null,a)}e.RongIMClient.isNotPullMsg||s._client.syncTime(void 0,void 0,void 0,!0),e.Bridge._client.channel.socket.fire("StatusChanged",0),e.RongIMClient._memoryStore.connectAckTime=o,(new Date).getTime()-o?e.RongIMClient._memoryStore.deltaTime=(new Date).getTime()-o:e.RongIMClient._memoryStore.deltaTime=0}else if(6==t){var c={},u=this;(new e.Navigation).getServerEndpoint(this._client.token,this._client.appId,function(){u._client.clearHeartbeat(),new e.Client(u._client.token,u._client.appId).__init.call(c,function(){"websocket"==e.Transportations._TransportType&&u._client.keepLive()}),u._client.channel.socket.fire("StatusChanged",2)},u._timeout,!1)}else e.Bridge._client.channel.socket.socket._status=t,this._client.reconnectObj.onError?(this._client.reconnectObj.onError(t),delete this._client.reconnectObj.onError):this._timeout(t)},o.prototype.readTimeOut=function(e){t.prototype.readTimeOut.call(this,e)},o}(t);e.ConnectAck=r}(RongIMLib||(RongIMLib={})),function(e){var t=(e.md5,function(){function t(){}return t.prototype.connect=function(t,n,o){var s=e.RongIMClient._storageProvider.getItem("appId");s&&s!=t&&(e.RongIMClient._storageProvider.clearItem(),e.RongIMClient._storageProvider.setItem("appId",t)),s||e.RongIMClient._storageProvider.setItem("appId",t);var r=tools.convertToken(n),i=new e.Client(r,t);return this.getServerEndpoint(n,t,function(){i.connect(o)},o.onError,!0),i},t.prototype.getServerEndpoint=function(e,t,n,o,s){n()},t.Endpoint=new Object,t}());e.Navigation=t}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(t){this._name="BaseMessage",this.lengthSize=0,t instanceof e.Header?this._header=t:this._header=new e.Header(t,!1,e.Qos.AT_MOST_ONCE,!1)}return t.prototype.read=function(e,t){this.readMessage(e,t)},t.prototype.write=function(t){var n=new e.BinaryHelper,o=n.convertStream(t);return this._headerCode=this.getHeaderFlag(),o.write(this._headerCode),this.writeMessage(o),o},t.prototype.getHeaderFlag=function(){return this._header.encode()},t.prototype.getLengthSize=function(){return this.lengthSize},t.prototype.toBytes=function(){return this.write([]).getBytesArray()},t.prototype.isRetained=function(){return this._header.retain},t.prototype.setRetained=function(e){this._header.retain=e},t.prototype.setQos=function(t){this._header.qos="[object Object]"==Object.prototype.toString.call(t)?t:e.Qos[t]},t.prototype.setDup=function(e){this._header.dup=e},t.prototype.isDup=function(){return this._header.dup},t.prototype.getType=function(){return this._header.type},t.prototype.getQos=function(){return this._header.qos},t.prototype.messageLength=function(){return 0},t.prototype.writeMessage=function(e){},t.prototype.readMessage=function(e,t){},t.prototype.init=function(e){var t,n,o=this;for(n in e)e.hasOwnProperty(n)&&(t=n.replace(/^\w/,function(e){var t=e.charCodeAt(0);return"set"+(t>=97?String.fromCharCode(-33&t):e)}))in o&&("status"==n?o[t](disconnectStatus[e[n]]?disconnectStatus[e[n]]:e[n]):o[t](e[n]))},t}();e.BaseMessage=t;var n=function(t){function n(n){switch(t.call(this,0==arguments.length||3==arguments.length?e.Type.CONNECT:arguments[0]),this._name="ConnectMessage",this.CONNECT_HEADER_SIZE=12,this.protocolId="RCloud",this.binaryHelper=new e.BinaryHelper,this.protocolVersion=3,arguments.length){case 0:case 1:case 3:if(!arguments[0]||arguments[0].length>64)throw new Error("ConnectMessage:Client Id cannot be null and must be at most 64 characters long: "+arguments[0]);this.clientId=arguments[0],this.cleanSession=arguments[1],this.keepAlive=arguments[2]}}return __extends(n,t),n.prototype.messageLength=function(){var e=this.binaryHelper.toMQttString(this.clientId).length;return e+=this.binaryHelper.toMQttString(this.willTopic).length,e+=this.binaryHelper.toMQttString(this.will).length,e+=this.binaryHelper.toMQttString(this.appId).length,(e+=this.binaryHelper.toMQttString(this.token).length)+this.CONNECT_HEADER_SIZE},n.prototype.readMessage=function(e){this.protocolId=e.readUTF(),this.protocolVersion=e.readByte();var t=e.readByte();if(this.hasAppId=(128&t)>0,this.hasToken=(64&t)>0,this.retainWill=(32&t)>0,this.willQos=t>>3&3,this.hasWill=(4&t)>0,this.cleanSession=(32&t)>0,this.keepAlive=256*e.read()+e.read(),this.clientId=e.readUTF(),this.hasWill&&(this.willTopic=e.readUTF(),this.will=e.readUTF()),this.hasAppId)try{this.appId=e.readUTF()}catch(e){throw new Error(e)}if(this.hasToken)try{this.token=e.readUTF()}catch(e){throw new Error(e)}return e},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);t.writeUTF(this.protocolId),t.write(this.protocolVersion);var n=this.cleanSession?2:0;return n|=this.hasWill?4:0,n|=this.willQos?this.willQos>>3:0,n|=this.retainWill?32:0,n|=this.hasToken?64:0,n|=this.hasAppId?128:0,t.write(n),t.writeChar(this.keepAlive),t.writeUTF(this.clientId),this.hasWill&&(t.writeUTF(this.willTopic),t.writeUTF(this.will)),this.hasAppId&&t.writeUTF(this.appId),this.hasToken&&t.writeUTF(this.token),t},n}(t);e.ConnectMessage=n;var o=function(t){function n(n){t.call(this,0==arguments.length?e.Type.CONNACK:1==arguments.length?arguments[0]instanceof e.Header?arguments[0]:e.Type.CONNACK:null),this._name="ConnAckMessage",this.MESSAGE_LENGTH=2,this.binaryHelper=new e.BinaryHelper;var o=this;switch(arguments.length){case 0:case 1:if(!(arguments[0]instanceof e.Header)&&arguments[0]in e.ConnectionState){if(null==arguments[0])throw new Error("ConnAckMessage:The status of ConnAskMessage can't be null");o.setStatus(arguments[0])}}}return __extends(n,t),n.prototype.messageLength=function(){var e=this.MESSAGE_LENGTH;return this.userId&&(e+=this.binaryHelper.toMQttString(this.userId).length),e},n.prototype.readMessage=function(e,t){e.read();var n=+e.read();if(!(n>=0&&n<=12))throw new Error("Unsupported CONNACK code:"+n);if(this.setStatus(n),t>this.MESSAGE_LENGTH){this.setUserId(e.readUTF());var o=(e.readUTF(),e.readLong());this.setTimestamp(o)}},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);switch(t.write(128),+status){case 0:case 1:case 2:case 5:case 6:t.write(+status);break;case 3:case 4:t.write(3);break;default:throw new Error("Unsupported CONNACK code:"+status)}return this.userId&&t.writeUTF(this.userId),t},n.prototype.setStatus=function(e){this.status=e},n.prototype.setUserId=function(e){this.userId=e},n.prototype.getStatus=function(){return this.status},n.prototype.getUserId=function(){return this.userId},n.prototype.setTimestamp=function(e){this.timestrap=e},n.prototype.getTimestamp=function(){return this.timestrap},n}(t);e.ConnAckMessage=o;var s=function(t){function n(n){t.call(this,n instanceof e.Header?n:e.Type.DISCONNECT),this._name="DisconnectMessage",this.MESSAGE_LENGTH=2,this.binaryHelper=new e.BinaryHelper,n instanceof e.Header||n in e.ConnectionStatus&&(this.status=n)}return __extends(n,t),n.prototype.messageLength=function(){return this.MESSAGE_LENGTH},n.prototype.readMessage=function(e){e.read();var t=+e.read();if(!(t>=0&&t<=5))throw new Error("Unsupported CONNACK code:"+t);this.setStatus(disconnectStatus[t]?disconnectStatus[t]:t)},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);if(t.write(0),!(+status>=1&&+status<=3))throw new Error("Unsupported CONNACK code:"+status);t.write(+status-1)},n.prototype.setStatus=function(e){this.status=e},n.prototype.getStatus=function(){return this.status},n}(t);e.DisconnectMessage=s;var r=function(t){function n(n){t.call(this,n&&n instanceof e.Header?n:e.Type.PINGREQ),this._name="PingReqMessage"}return __extends(n,t),n}(t);e.PingReqMessage=r;var i=function(t){function n(n){t.call(this,n&&n instanceof e.Header?n:e.Type.PINGRESP),this._name="PingRespMessage"}return __extends(n,t),n}(t);e.PingRespMessage=i;var a=function(t){function n(n){t.call(this,n),this._name="RetryableMessage",this.binaryHelper=new e.BinaryHelper}return __extends(n,t),n.prototype.messageLength=function(){return 2},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e),n=this.getMessageId(),o=255&n,s=(65280&n)>>8;return t.write(s),t.write(o),t},n.prototype.readMessage=function(e,t){var n=256*e.read()+e.read();this.setMessageId(parseInt(n,10))},n.prototype.setMessageId=function(e){this.messageId=e},n.prototype.getMessageId=function(){return this.messageId},n}(t);e.RetryableMessage=a;var c=function(t){function n(n){t.call(this,n instanceof e.Header?n:e.Type.PUBACK),this.msgLen=2,this.date=0,this.millisecond=0,this.timestamp=0,this.binaryHelper=new e.BinaryHelper,this._name="PubAckMessage",n instanceof e.Header||t.prototype.setMessageId.call(this,n)}return __extends(n,t),n.prototype.messageLength=function(){return this.msgLen},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);a.prototype.writeMessage.call(this,t)},n.prototype.readMessage=function(e,t){a.prototype.readMessage.call(this,e),this.date=e.readInt(),this.status=256*e.read()+e.read(),this.millisecond=256*e.read()+e.read(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=e.readUTF()},n.prototype.setStatus=function(e){this.status=e},n.prototype.setTimestamp=function(e){this.timestamp=e},n.prototype.setMessageUId=function(e){this.messageUId=e},n.prototype.getStatus=function(){return this.status},n.prototype.getDate=function(){return this.date},n.prototype.getTimestamp=function(){return this.timestamp},n.prototype.getMessageUId=function(){return this.messageUId},n}(a);e.PubAckMessage=c;var u=function(t){function n(n,o,s){t.call(this,1==arguments.length&&n instanceof e.Header?n:3==arguments.length?e.Type.PUBLISH:0),this._name="PublishMessage",this.binaryHelper=new e.BinaryHelper,this.syncMsg=!1,3==arguments.length&&(this.topic=n,this.targetId=s,this.data="string"==typeof o?this.binaryHelper.toMQttString(o):o)}return __extends(n,t),n.prototype.messageLength=function(){var e=10;return e+=this.binaryHelper.toMQttString(this.topic).length,e+=this.binaryHelper.toMQttString(this.targetId).length,e+=this.data.length},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);t.writeUTF(this.topic),t.writeUTF(this.targetId),a.prototype.writeMessage.apply(this,arguments),t.write(this.data)},n.prototype.readMessage=function(e,t){var n=6;this.date=e.readInt(),this.topic=e.readUTF(),n+=this.binaryHelper.toMQttString(this.topic).length,this.targetId=e.readUTF(),n+=this.binaryHelper.toMQttString(this.targetId).length,a.prototype.readMessage.apply(this,arguments),this.data=new Array(t-n),this.data=e.read(this.data)},n.prototype.setTopic=function(e){this.topic=e},n.prototype.setData=function(e){this.data=e},n.prototype.setTargetId=function(e){this.targetId=e},n.prototype.setDate=function(e){this.date=e},n.prototype.setSyncMsg=function(e){this.syncMsg=e},n.prototype.getSyncMsg=function(){return this.syncMsg},n.prototype.getTopic=function(){return this.topic},n.prototype.getData=function(){return this.data},n.prototype.getTargetId=function(){return this.targetId},n.prototype.getDate=function(){return this.date},n}(a);e.PublishMessage=u;var g=function(t){function n(n,o,s){t.call(this,n instanceof e.Header?n:3==arguments.length?e.Type.QUERY:null),this.binaryHelper=new e.BinaryHelper,this._name="QueryMessage",3==arguments.length&&(this.data="string"==typeof o?this.binaryHelper.toMQttString(o):o,this.topic=n,this.targetId=s)}return __extends(n,t),n.prototype.messageLength=function(){var e=0;return e+=this.binaryHelper.toMQttString(this.topic).length,e+=this.binaryHelper.toMQttString(this.targetId).length,e+=2,e+=this.data.length},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);t.writeUTF(this.topic),t.writeUTF(this.targetId),a.prototype.writeMessage.call(this,t),t.write(this.data)},n.prototype.readMessage=function(e,t){var n=0;this.topic=e.readUTF(),this.targetId=e.readUTF(),n+=this.binaryHelper.toMQttString(this.topic).length,n+=this.binaryHelper.toMQttString(this.targetId).length,this.readMessage.apply(this,arguments),n+=2,this.data=new Array(t-n),e.read(this.data)},n.prototype.setTopic=function(e){this.topic=e},n.prototype.setData=function(e){this.data=e},n.prototype.setTargetId=function(e){this.targetId=e},n.prototype.getTopic=function(){return this.topic},n.prototype.getData=function(){return this.data},n.prototype.getTargetId=function(){return this.targetId},n}(a);e.QueryMessage=g;var p=function(t){function n(n){t.call(this,n instanceof e.Header?n:e.Type.QUERYCON),this._name="QueryConMessage",n instanceof e.Header||t.prototype.setMessageId.call(this,n)}return __extends(n,t),n}(a);e.QueryConMessage=p;var d=function(t){function n(n){t.call(this,n),this._name="QueryAckMessage",this.binaryHelper=new e.BinaryHelper}return __extends(n,t),n.prototype.readMessage=function(e,t){a.prototype.readMessage.call(this,e),this.date=e.readInt(),this.setStatus(256*e.read()+e.read()),t>0&&(this.data=new Array(t-8),this.data=e.read(this.data))},n.prototype.getData=function(){return this.data},n.prototype.getStatus=function(){return this.status},n.prototype.getDate=function(){return this.date},n.prototype.setDate=function(e){this.date=e},n.prototype.setStatus=function(e){this.status=e},n.prototype.setData=function(e){this.data=e},n}(a);e.QueryAckMessage=d}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(t){var n=new e.BinaryHelper;this.out=n.convertStream(t)}return t.prototype.writeMessage=function(t){t instanceof e.BaseMessage&&t.write(this.out)},t}();e.MessageOutputStream=t;var n=function(){function t(t,n){if(n)this.flags=t.headerCode;else{var o=(new e.BinaryHelper).convertStream(t);this.flags=o.readByte(),this._in=o}this.header=new e.Header(this.flags),this.isPolling=n,this.In=t}return t.prototype.readMessage=function(){switch(this.header.getType()){case 1:this.msg=new e.ConnectMessage(this.header);break;case 2:this.msg=new e.ConnAckMessage(this.header);break;case 3:this.msg=new e.PublishMessage(this.header),this.msg.setSyncMsg(this.header.getSyncMsg());break;case 4:this.msg=new e.PubAckMessage(this.header);break;case 5:this.msg=new e.QueryMessage(this.header);break;case 6:this.msg=new e.QueryAckMessage(this.header);break;case 7:this.msg=new e.QueryConMessage(this.header);break;case 9:case 11:case 13:this.msg=new e.PingRespMessage(this.header);break;case 8:case 10:case 12:this.msg=new e.PingReqMessage(this.header);break;case 14:this.msg=new e.DisconnectMessage(this.header);break;default:throw new Error("No support for deserializing "+this.header.getType()+" messages")}return this.isPolling?this.msg.init(this.In):this.msg.read(this._in,this.In.length-1),this.msg},t}();e.MessageInputStream=n;var o=function(){function t(t,n,o,s){this.retain=!1,this.qos=e.Qos.AT_LEAST_ONCE,this.dup=!1,this.syncMsg=!1,t&&+t==t&&1==arguments.length?(this.retain=(1&t)>0,this.qos=(6&t)>>1,this.dup=(8&t)>0,this.type=t>>4&15,this.syncMsg=8==(8&t)):(this.type=t,this.retain=n,this.qos=o,this.dup=s)}return t.prototype.getSyncMsg=function(){return this.syncMsg},t.prototype.getType=function(){return this.type},t.prototype.encode=function(){var t=this;switch(this.qos){case e.Qos[0]:t.qos=e.Qos.AT_MOST_ONCE;break;case e.Qos[1]:t.qos=e.Qos.AT_LEAST_ONCE;break;case e.Qos[2]:t.qos=e.Qos.EXACTLY_ONCE;break;case e.Qos[3]:t.qos=e.Qos.DEFAULT}var n=this.type<<4;return n|=this.retain?1:0,n|=this.qos<<1,n|=this.dup?8:0},t.prototype.toString=function(){return"Header [type="+this.type+",retain="+this.retain+",qos="+this.qos+",dup="+this.dup+"]"},t}();e.Header=o;var s=function(){function e(){}return e.prototype.writeUTF=function(e,t){for(var n=[],o=0,s=0,r=e.length;s<r;s++){var i=e.charCodeAt(s);i>=0&&i<=127?(o+=1,n.push(i)):i>=128&&i<=2047?(o+=2,n.push(192|31&i>>6),n.push(128|63&i)):i>=2048&&i<=65535&&(o+=3,n.push(224|15&i>>12),n.push(128|63&i>>6),n.push(128|63&i))}for(var s=0,r=n.length;s<r;s++)n[s]>255&&(n[s]&=255);return t?n:o<=255?[0,o].concat(n):[o>>8,255&o].concat(n)},e.prototype.readUTF=function(e){if("[object String]"==Object.prototype.toString.call(e))return e;for(var t="",n=e,o=0,s=n.length;o<s;o++){n[o]<0&&(n[o]+=256);var r=n[o].toString(2),i=r.match(/^1+?(?=0)/);if(i&&8==r.length){for(var a=i[0].length,c="",u=0;u<a;u++)c+=n[u+o].toString(2).slice(2);t+=String.fromCharCode(parseInt(c,2)),o+=a-1}else t+=String.fromCharCode(n[o])}return t},e.prototype.convertStream=function(e){return e instanceof r?e:new r(e)},e.prototype.toMQttString=function(e){return this.writeUTF(e)},e}();e.BinaryHelper=s;var r=function(){function e(e){this.position=0,this.writen=0,this.poolLen=0,this.binaryHelper=new s,this.pool=e,this.poolLen=e.length}return e.prototype.check=function(){return this.position>=this.pool.length},e.prototype.readInt=function(){if(this.check())return-1;for(var e="",t=0;t<4;t++){var n=this.pool[this.position++].toString(16);1==n.length&&(n="0"+n),e+=n.toString(16)}return parseInt(e,16)},e.prototype.readLong=function(){if(this.check())return-1;for(var e="",t=0;t<8;t++){var n=this.pool[this.position++].toString(16);1==n.length&&(n="0"+n),e+=n}return parseInt(e,16)},e.prototype.readTimestamp=function(){if(this.check())return-1;for(var e="",t=0;t<8;t++)e+=this.pool[this.position++].toString(16);return e=e.substring(2,8),parseInt(e,16)},e.prototype.readUTF=function(){if(this.check())return-1;var e=this.readByte()<<8|this.readByte();return this.binaryHelper.readUTF(this.pool.subarray(this.position,this.position+=e))},e.prototype.readByte=function(){if(this.check())return-1;var e=this.pool[this.position++];return e>255&&(e&=255),e},e.prototype.read=function(e){return e?this.pool.subarray(this.position,this.poolLen):this.readByte()},e.prototype.write=function(e){var t=e;return"[object array]"==Object.prototype.toString.call(t).toLowerCase()?[].push.apply(this.pool,t):+t==t&&(t>255&&(t&=255),this.pool.push(t),this.writen++),t},e.prototype.writeChar=function(e){if(+e!=e)throw new Error("writeChar:arguments type is error");this.write(e>>8&255),this.write(255&e),this.writen+=2},e.prototype.writeUTF=function(e){var t=this.binaryHelper.writeUTF(e);[].push.apply(this.pool,t),this.writen+=t.length},e.prototype.toComplements=function(){for(var e=this.pool,t=0;t<this.poolLen;t++)e[t]>128&&(e[t]-=256);return e},e.prototype.getBytesArray=function(e){return e?this.toComplements():this.pool},e}();e.RongIMStream=r}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(e){return this.empty=new Function,this.connected=!1,this.pid=+new Date+Math.random()+"",this.queue=[],this.socket=e,this}return t.prototype.createTransport=function(t,n){if(!t)throw new Error("Url is empty,Please check it!");this.url=t;var o=e.RongIMClient._storageProvider.getItem("sId"+e.Navigation.Endpoint.userId),s=this;return o?(setTimeout(function(){s.onSuccess('{"status":0,"userId":"'+e.Navigation.Endpoint.userId+'","headerCode":32,"messageId":0,"sessionid":"'+o+'"}'),s.connected=!0},500),this):(this.getRequest(t,!0),this)},t.prototype.getRequest=function(t,n,o){o=o||{};var s=o.callback||function(){},r=this,i=encodeURIComponent(r.pid),a=e.RongIMClient._memoryStore.depend.protocol,t=tools.tplEngine("{protocol}{url}&pid={pid}",{protocol:a,url:t,pid:i});r.xhr=tools.request({url:t,data:{t:Math.random()}},{success:function(t){if(400==t.statusCode)return void r.onError();var o=t.data;if(3==o.status)return r.onError(e.ErrorCode.MINI_PROGAM_SERVICE_NOT_OPEN);r.onSuccess(JSON.stringify(o),n),s()},fail:function(){r.onError()}})},t.prototype.send=function(t){var n=this,o=t.url,s=e.RongIMClient._memoryStore.depend.cmp,r=e.RongIMClient._memoryStore.depend.protocol,i=encodeURIComponent(n.pid),a=tools.tplEngine("{protocol}{host}/websocket{path}&pid={pid}",{protocol:r,host:s,path:o,pid:i}),c=JSON.stringify(t.data),u=this;n.sendxhr=tools.request({url:a,method:"POST",data:c},{success:function(t){var o=t.data;if(o){if(400==t.statusCode)return u.onClose(),void u.socket.fire("StatusChanged",e.ConnectionStatus.NETWORK_UNAVAILABLE);o=JSON.stringify(o),n.onData(o)}},fail:function(e){console.log("inner sendmessage error",e)}})},t.prototype.onData=function(t,n){var o=this,s=JSON.parse(t);return s.userId&&(e.Navigation.Endpoint.userId=s.userId),n&&e.RongIMClient._storageProvider.setItem("sId"+e.Navigation.Endpoint.userId,n),e.MessageUtil.isArray(s)||(s=[s]),Array.forEach(s,function(t){o.socket.fire("message",new e.MessageInputStream(t,!0).readMessage())}),""},t.prototype.onClose=function(){this.xhr&&(this.xhr.abort(),this.xhr=null),this.sendxhr&&(this.sendxhr.abort(),this.sendxhr=null)},t.prototype.disconnect=function(){e.RongIMClient._storageProvider.removeItem("sId"+e.Navigation.Endpoint.userId),e.RongIMClient._storageProvider.removeItem(e.Navigation.Endpoint.userId+"msgId"),this.onClose()},t.prototype.reconnect=function(){this.disconnect(),this.createTransport(this.url)},t.prototype.onSuccess=function(t,n){var o=t.match(/"sessionid":"\S+?(?=")/);if(this.onData(t,o?o[0].slice(13):0),/"headerCode":-32,/.test(t))return e.RongIMClient._storageProvider.removeItem("sId"+e.Navigation.Endpoint.userId),void e.RongIMClient._storageProvider.removeItem(e.Navigation.Endpoint.userId+"msgId");var s=e.RongIMClient._memoryStore.depend.cmp;if(4==JSON.parse(t).status)return e.RongIMClient._storageProvider.removeItem("sId"+e.Navigation.Endpoint.userId),void e.RongIMClient._storageProvider.removeItem(e.Navigation.Endpoint.userId+"msgId");this.getRequest(s+"/pullmsg.js?sessionid="+e.RongIMClient._storageProvider.getItem("sId"+e.Navigation.Endpoint.userId)+"&timestrap="+encodeURIComponent((new Date).getTime()+Math.random()+"")),this.connected=!0,n&&this.socket.fire("connect")},t.prototype.onError=function(t){e.RongIMClient._storageProvider.removeItem("sId"+e.Navigation.Endpoint.userId),e.RongIMClient._storageProvider.removeItem(e.Navigation.Endpoint.userId+"msgId"),this.onClose(),this.connected=!1,t=t||e.ConnectionStatus.NETWORK_UNAVAILABLE,this.socket.fire("disconnect",t)},t}();e.PollingTransportation=t}(RongIMLib||(RongIMLib={}));var typeMapping={"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:FileMsg":"FileMessage","RC:LBSMsg":"LocationMessage","RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage","RC:CmdMsg":"CommandMessage","RC:TypSts":"TypingStatusMessage","RC:CsChaR":"ChangeModeResponseMessage","RC:CsHsR":"HandShakeResponseMessage","RC:CsEnd":"TerminateMessage","RC:CsSp":"SuspendMessage","RC:CsUpdate":"CustomerStatusUpdateMessage","RC:ReadNtf":"ReadReceiptMessage","RC:VCAccept":"AcceptMessage","RC:VCRinging":"RingingMessage","RC:VCSummary":"SummaryMessage","RC:VCHangup":"HungupMessage","RC:VCInvite":"InviteMessage","RC:VCModifyMedia":"MediaModifyMessage","RC:VCModifyMem":"MemberModifyMessage","RC:CsContact":"CustomerContact","RC:PSImgTxtMsg":"PublicServiceRichContentMessage","RC:PSMultiImgTxtMsg":"PublicServiceMultiRichContentMessage","RC:GrpNtf":"GroupNotificationMessage","RC:PSCmd":"PublicServiceCommandMessage","RC:RcCmd":"RecallCommandMessage","RC:SRSMsg":"SyncReadStatusMessage","RC:RRReqMsg":"ReadReceiptRequestMessage","RC:RRRspMsg":"ReadReceiptResponseMessage","RCJrmf:RpMsg":"JrmfReadPacketMessage","RCJrmf:RpOpendMsg":"JrmfReadPacketOpenedMessage"},registerMessageTypeMapping={},HistoryMsgType={4:"qryCMsg",2:"qryDMsg",3:"qryGMsg",1:"qryPMsg",6:"qrySMsg",7:"qryPMsg",8:"qryPMsg",5:"qryCMsg"},disconnectStatus={1:6};return function(e){var t=function(){function t(){}return t._TransportType=e.Socket.WEBSOCKET,t}();e.Transportations=t;var n=function(){function t(){}t.supportLargeStorage=function(){return!0},t.checkStorageSize=function(){return JSON.stringify(localStorage).length<468e4},t.getFirstKey=function(e){var t="";for(var n in e){t=n;break}return t},t.isEmpty=function(e){var t=!0;for(var n in e){t=!1;break}return t},t.ArrayForm=function(e){if("[object ArrayBuffer]"==Object.prototype.toString.call(e)){var t=new Int8Array(e);return[].slice.call(t)}return e},t.ArrayFormInput=function(e){if("[object ArrayBuffer]"==Object.prototype.toString.call(e)){return new Uint8Array(e)}return e},t.indexOf=function(e,t,n){for(var o=e.length,s=n<0?Math.max(0,+n):n||0;s<o;s++)if(e[s]==t)return s;return-1},t.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},t.forEach=function(e,t){return[].forEach?function(e,t){[].forEach.call(e,t)}:function(e,t){for(var n=0;n<e.length;n++)t.call(e,e[n],n,e)}},t.remove=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n]))return e.splice(n,1)[0];return null},t.int64ToTimestamp=function(e,t){if(void 0===e.low)return e;var n=e.low;n<0&&(n+=4294967296),n=n.toString(16);var o=parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+n.length+"}$"),n),16);return t?new Date(o):o};var n=function(t){var n=e.Bridge._client||{},o=n.userId,s=1==t.messageDirection?"send":"received";return tools.tplEngine("{userId}_{direction}box",{userId:o,direction:s})};return t.updateSyncTime=function(t){var o=n(t),s=t.sentTime;e.RongIMClient._storageProvider.setItem(o,s)},t.getSyncTime=function(){var t=n({messageDirection:e.MessageDirection.SEND}),o=n({messageDirection:e.MessageDirection.RECEIVED}),s=e.RongIMClient._storageProvider;return{send:s.getItem(t)||0,received:s.getItem(o)||0}},t.messageParser=function(n,o,s){var r,i,a=new e.Message,c=n.content,u=n.classname,g=!1;try{e.RongIMClient._memoryStore.depend.isPolling?(i=(new e.BinaryHelper).readUTF(c.offset?t.ArrayForm(c.buffer).slice(c.offset,c.limit):c),r=JSON.parse(i)):(i=(new e.BinaryHelper).readUTF(c.offset?t.ArrayFormInput(c.buffer).subarray(c.offset,c.limit):c),r=JSON.parse(i))}catch(e){r=i,g=!0}if(u in typeMapping)a.content=new e[typeMapping[u]](r),a.messageType=typeMapping[u];else if(u in registerMessageTypeMapping){var c=new e.RongIMClient.RegisterMessage[registerMessageTypeMapping[u]](r);a.content=g?c.decode(r):c,a.messageType=registerMessageTypeMapping[u]}else a.content=new e.UnknownMessage({content:r,objectName:u}),a.messageType="UnknownMessage";var p=t.int64ToTimestamp(n.dataTime);return a.sentTime=p>0?p:+new Date,a.senderUserId=n.fromUserId,a.conversationType=n.type,n.fromUserId==e.Bridge._client.userId?a.targetId=n.groupId:a.targetId=/^[234]$/.test(n.type||n.getType())?n.groupId:a.senderUserId,1==n.direction?(a.messageDirection=e.MessageDirection.SEND,a.senderUserId=e.Bridge._client.userId):a.senderUserId==e.Bridge._client.userId?a.messageDirection=e.MessageDirection.SEND:a.messageDirection=e.MessageDirection.RECEIVE,a.receivedStatus=e.ReceivedStatus.READ,2==(2&n.status)&&(a.receivedStatus=e.ReceivedStatus.RETRIEVED),a.messageUId=n.msgId,a.receivedTime=(new Date).getTime(),a.messageId=a.conversationType+"_"+~~(16777215*Math.random()),a.objectName=u,a.offLineMessage=!!s,s||e.RongIMClient._memoryStore.connectAckTime>a.sentTime&&(a.offLineMessage=!0),a},t.sign={converNum:1,msgNum:1,isMsgStart:!0,isConvStart:!0},t}();e.MessageUtil=n;var o=function(){function e(){}return e.init=function(){this.messageId=0},e.messageIdPlus=function(e){return this.messageId>=65535?(e(),!1):(this.messageId+=1,this.messageId)},e.clearMessageId=function(){this.messageId=0},e.getMessageId=function(){return this.messageId},e.messageId=0,e}();e.MessageIdHandler=o}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function e(e){throw new Error("This method is abstract, you must implement this method in inherited class.")}return e.obtain=function(){throw new Error("This method is abstract, you must implement this method in inherited class.")},e}();e.MessageContent=t;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.NotificationMessage=n;var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.StatusMessage=o;var s=function(){function t(){}return t.modelClone=function(e){var t={};for(var n in e)"messageName"!=n&&"encode"!=n&&(t[n]=e[n]);return t},t.modleCreate=function(t,n){if(t.length<1)throw new Error("Array is empty  -> registerMessageType.modleCreate");return function o(s){var r=this;for(var i in t)r[t[i]]=s[t[i]];o.prototype.messageName=n,o.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))}}},t}();e.ModelUtil=s}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(e){this.messageName="CustomerStatusMessage",this.status=e.status}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CustomerStatusMessage=t;var n=function(){function t(e){this.messageName="ChangeModeResponseMessage",this.code=e.code,this.data=e.data,this.msg=e.msg}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ChangeModeResponseMessage=n;var o=function(){function t(e){this.messageName="ChangeModeMessage",this.uid=e.uid,this.sid=e.sid,this.pid=e.pid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ChangeModeMessage=o;var s=function(){function t(e){this.messageName="CustomerStatusUpdateMessage",this.serviceStatus=e.serviceStatus,this.sid=e.sid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CustomerStatusUpdateMessage=s;var r=function(){function t(e){this.messageName="HandShakeMessage",e&&(this.groupid=e.groupid)}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.HandShakeMessage=r;var i=function(){function t(e){this.messageName="CustomerContact",this.page=e.page,this.nickName=e.nickName,this.routingInfo=e.routingInfo,this.info=e.info,this.requestInfo=e.requestInfo}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CustomerContact=i;var a=function(){function t(e){this.messageName="EvaluateMessage",this.uid=e.uid,this.sid=e.sid,this.pid=e.pid,this.source=e.source,this.suggest=e.suggest,this.isresolve=e.isresolve,this.type=e.type}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.EvaluateMessage=a;var c=function(){function t(e){this.messageName="HandShakeResponseMessage",this.msg=e.msg,this.status=e.status,this.data=e.data}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.HandShakeResponseMessage=c;var u=function(){function t(e){this.messageName="SuspendMessage",this.uid=e.uid,this.sid=e.sid,this.pid=e.pid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.SuspendMessage=u;var g=function(){function t(e){this.messageName="TerminateMessage",this.code=e.code,this.msg=e.msg,this.sid=e.sid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.TerminateMessage=g}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function e(e){this.messageName="IsTypingStatusMessage"}return e.prototype.encode=function(){},e.prototype.getMessage=function(){return null},e}();e.IsTypingStatusMessage=t}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(e){if(this.messageName="InformationNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> InformationNotificationMessage.");this.message=e.message,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e){return new t({message:e,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.InformationNotificationMessage=t;var n=function(){function t(e){if(this.messageName="CommandMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> CommandMessage.");try{"[object String]"==Object.prototype.toString.call(e.data)?this.data=JSON.parse(e.data):this.data=e.data}catch(t){this.data=e.data}this.name=e.name,this.extra=e.extra}return t.obtain=function(e){return new t({data:e,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CommandMessage=n;var o=function(){function n(e){if(this.messageName="ContactNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ContactNotificationMessage.");this.operation=e.operation,this.targetUserId=e.targetUserId,this.message=e.message,this.extra=e.extra,this.sourceUserId=e.sourceUserId,e.user&&(this.user=e.user)}return n.obtain=function(e,n,o,s){return new t({operation:e,sourceUserId:n,targetUserId:o,message:s})},n.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},n.CONTACT_OPERATION_ACCEPT_RESPONSE="ContactOperationAcceptResponse",n.CONTACT_OPERATION_REJECT_RESPONSE="ContactOperationRejectResponse",n.CONTACT_OPERATION_REQUEST="ContactOperationRequest",n}();e.ContactNotificationMessage=o;var s=function(){function t(e){if(this.messageName="ProfileNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ProfileNotificationMessage.");this.operation=e.operation;try{"[object String]"==Object.prototype.toString.call(e.data)?this.data=JSON.parse(e.data):this.data=e.data}catch(t){this.data=e.data}this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n){return new t({operation:e,data:n})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ProfileNotificationMessage=s;var r=function(){function t(e){if(this.messageName="CommandNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ProfileNotificationMessage.");try{"[object String]"==Object.prototype.toString.call(e.data)?this.data=JSON.parse(e.data):this.data=e.data}catch(t){this.data=e.data}this.name=e.name,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n){return new t({name:e,data:n,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CommandNotificationMessage=r;var i=function(){function t(e){if(this.messageName="DiscussionNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> DiscussionNotificationMessage.");this.extra=e.extra,this.extension=e.extension,this.type=e.type,this.isHasReceived=e.isHasReceived,this.operation=e.operation,this.user=e.user,e.user&&(this.user=e.user)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.DiscussionNotificationMessage=i;var a=function(){function t(e){if(this.messageName="GroupNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> GroupNotificationMessage.");e.operatorUserId&&(this.operatorUserId=e.operatorUserId),e.operation&&(this.operation=e.operation),e.data&&(this.data=e.data),e.message&&(this.message=e.message)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.GroupNotificationMessage=a}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(e){if(this.messageName="TextMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> TextMessage.");this.content=e.content,this.extra=e.extra,e.user&&(this.user=e.user),e.mentionedInfo&&(this.mentionedInfo=e.mentionedInfo)}return t.obtain=function(e){return new t({extra:"",content:e})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.TextMessage=t;var n=function(){function t(e){if(this.messageName="TypingStatusMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> TypingStatusMessage.");this.typingContentType=e.typingContentType,this.data=e.data}return t.obtain=function(e,n){return new t({typingContentType:e,data:n})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.TypingStatusMessage=n;var o=function(){function t(e){if(this.messageName="ReadReceiptMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ReadReceiptMessage.");this.lastMessageSendTime=e.lastMessageSendTime,this.messageUId=e.messageUId,this.type=e.type}return t.obtain=function(e,n,o){return new t({messageUId:e,lastMessageSendTime:n,type:o})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ReadReceiptMessage=o;var s=function(){function t(e){if(this.messageName="VoiceMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> VoiceMessage.");this.content=e.content,this.duration=e.duration,this.extra=e.extra,e.user&&(this.user=e.user),e.mentionedInfo&&(this.mentionedInfo=e.mentionedInfo)}return t.obtain=function(e,n){return new t({content:e,duration:n,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.VoiceMessage=s;var r=function(){function t(e){this.messageName="RecallCommandMessage",this.messageUId=e.messageUId,this.conversationType=e.conversationType,this.targetId=e.targetId,this.sentTime=e.sentTime,e.extra&&(this.extra=e.extra),e.user&&(this.user=e.user)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.RecallCommandMessage=r;var i=function(){function t(e){if(this.messageName="ImageMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ImageMessage.");this.content=e.content,this.imageUri=e.imageUri,e.extra&&(this.extra=e.extra),e.user&&(this.user=e.user),e.mentionedInfo&&(this.mentionedInfo=e.mentionedInfo)}return t.obtain=function(e,n){return new t({content:e,imageUri:n,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ImageMessage=i;var a=function(){function t(e){if(this.messageName="LocationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> LocationMessage.");this.latitude=e.latitude,this.longitude=e.longitude,this.poi=e.poi,this.content=e.content,this.extra=e.extra,e.user&&(this.user=e.user),e.mentionedInfo&&(this.mentionedInfo=e.mentionedInfo)}return t.obtain=function(e,n,o,s){return new t({latitude:e,longitude:n,poi:o,content:s,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.LocationMessage=a;var c=function(){function t(e){if(this.messageName="RichContentMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> RichContentMessage.");this.title=e.title,this.content=e.content,this.imageUri=e.imageUri,this.extra=e.extra,this.url=e.url,e.user&&(this.user=e.user)}return t.obtain=function(e,n,o,s){return new t({title:e,content:n,imageUri:o,url:s,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.RichContentMessage=c;var u=function(){function e(e){this.messageName="JrmfReadPacketMessage",e&&(this.message=e)}return e.prototype.encode=function(){return""},e}();e.JrmfReadPacketMessage=u;var g=function(){function e(e){this.messageName="JrmfReadPacketOpenedMessage",e&&(this.message=e)}return e.prototype.encode=function(){return""},e}();e.JrmfReadPacketOpenedMessage=g;var p=function(){function e(e){if(this.messageName="UnknownMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> UnknownMessage.");this.message=e}return e.prototype.encode=function(){return""},e}();e.UnknownMessage=p;var d=function(){function t(e){if(this.messageName="PublicServiceCommandMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> PublicServiceCommandMessage.");this.content=e.content,this.extra=e.extra,this.menuItem=e.menuItem,e.user&&(this.user=e.user),e.mentionedInfo&&(this.mentionedInfo=e.mentionedInfo)}return t.obtain=function(e){return new t({content:"",command:"",menuItem:e,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.PublicServiceCommandMessage=d;var l=function(){function e(e){this.messageName="PublicServiceMultiRichContentMessage",this.richContentMessages=e}return e.prototype.encode=function(){return null},e}();e.PublicServiceMultiRichContentMessage=l;var f=function(){function t(e){this.messageName="SyncReadStatusMessage",e.lastMessageSendTime&&(this.lastMessageSendTime=e.lastMessageSendTime)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.SyncReadStatusMessage=f;var h=function(){function t(e){this.messageName="ReadReceiptRequestMessage",e.messageUId&&(this.messageUId=e.messageUId)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ReadReceiptRequestMessage=h;var m=function(){function t(e){this.messageName="ReadReceiptResponseMessage",e.receiptMessageDic&&(this.receiptMessageDic=e.receiptMessageDic)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ReadReceiptResponseMessage=m;var M=function(){function t(e){this.messageName="PublicServiceRichContentMessage",this.richContentMessage=e}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.PublicServiceRichContentMessage=M;var I=function(){function t(e){this.messageName="FileMessage",e.name&&(this.name=e.name),e.size&&(this.size=e.size),e.type&&(this.type=e.type),e.fileUrl&&(this.fileUrl=e.fileUrl),e.extra&&(this.extra=e.extra),e.user&&(this.user=e.user)}return t.obtain=function(e){return new t({name:e.name,size:e.size,type:e.type,fileUrl:e.fileUrl})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.FileMessage=I;var C=function(){function t(e){this.messageName="AcceptMessage",this.callId=e.callId,this.mediaType=e.mediaType}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.AcceptMessage=C;var y=function(){function t(e){this.messageName="RingingMessage",this.callId=e.callId}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.RingingMessage=y;var R=function(){function t(e){this.messageName="SummaryMessage",this.caller=e.caller,this.inviter=e.inviter,this.mediaType=e.mediaType,this.memberIdList=e.memberIdList,this.startTime=e.startTime,this.connectedTime=e.connectedTime,this.duration=e.duration,this.status=e.status}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.SummaryMessage=R;var _=function(){function t(e){this.messageName="HungupMessage",this.callId=e.callId,this.reason=e.reason}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.HungupMessage=_;var S=function(){function t(e){this.messageName="InviteMessage",this.callId=e.callId,this.engineType=e.engineType,this.channelInfo=e.channelInfo,this.mediaType=e.mediaType,this.extra=e.extra,this.inviteUserIds=e.inviteUserIds}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.InviteMessage=S;var T=function(){function t(e){this.messageName="MediaModifyMessage",this.callId=e.callId,this.mediaType=e.mediaType}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.MediaModifyMessage=T;var E=function(){function t(e){this.messageName="MemberModifyMessage",this.modifyMemType=e.modifyMemType,this.callId=e.callId,this.caller=e.caller,this.engineType=e.engineType,this.channelInfo=e.channelInfo,this.mediaType=e.mediaType,this.extra=e.extra,this.inviteUserIds=e.inviteUserIds,this.existedMemberStatusList=e.existedMemberStatusList}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.MemberModifyMessage=E}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function e(e,t){this.Id=e,this.Key=t}return e}();e.ChannelInfo=t;var n=function(){function e(e,t,n){this.platform=e,this.online=t,this.status=n}return e}();e.UserStatus=n;var o=function(){function e(e,t,n){}return e}();e.MentionedInfo=o;var s=function(){function e(e,t,n){this.msgId=e,this.msgDataTime=t,this.direct=n}return e}();e.DeleteMessage=s;var r=function(){function e(e,t,n){}return e}();e.CustomServiceConfig=r;var i=function(){function e(e,t,n,o,s,r,i){}return e}();e.CustomServiceSession=i;var a=function(){function t(e,t,n,o,s,r,i,a,c,u,g,p,d,l,f,h,m,M,I,C){this.conversationTitle=e,this.conversationType=t,this.draft=n,this.isTop=o,this.latestMessage=s,this.latestMessageId=r,this.notificationStatus=i,this.objectName=a,this.receivedStatus=c,this.receivedTime=u,this.senderUserId=g,this.senderUserName=p,this.sentStatus=d,this.sentTime=l,this.targetId=f,this.unreadMessageCount=h,this.senderPortraitUri=m,this.isHidden=M,this.mentionedMsg=I,this.hasUnreadMention=C}return t.prototype.setTop=function(){e.RongIMClient._dataAccessProvider.addConversation(this,{onSuccess:function(e){}})},t}();e.Conversation=a;var c=function(){function e(e,t,n,o,s){this.creatorId=e,this.id=t,this.memberIdList=n,this.name=o,this.isOpen=s}return e}();e.Discussion=c;var u=function(){function e(e,t,n){this.id=e,this.name=t,this.portraitUri=n}return e}();e.Group=u;var g=function(){function e(e,t,n,o,s,r,i,a,c,u,g,p,d,l,f,h,m){this.content=e,this.conversationType=t,this.extra=n,this.objectName=o,this.messageDirection=s,this.messageId=r,this.receivedStatus=i,this.receivedTime=a,this.senderUserId=c,this.sentStatus=u,this.sentTime=g,this.targetId=p,this.messageType=d,this.messageUId=l,this.isLocalMessage=f,this.offLineMessage=h,this.receiptResponse=m}return e}();e.Message=g;var p=function(){function e(e,t){this.isCounted=e,this.isPersited=t}return e.prototype.getMessageTag=function(){return this.isCounted&&this.isPersited?3:this.isCounted?2:this.isPersited?1:this.isCounted||this.isPersited?void 0:0},e}();e.MessageTag=p;var d=function(){function e(e,t,n,o,s){this.id=e,this.name=t,this.type=n,this.sunMenuItems=o,this.url=s}return e}();e.PublicServiceMenuItem=d;var l=function(){function e(e,t,n,o,s,r,i,a){this.conversationType=e,this.introduction=t,this.menu=n,this.name=o,this.portraitUri=s,this.publicServiceId=r,this.hasFollowed=i,this.isGlobal=a}return e}();e.PublicServiceProfile=l;var f=function(){function e(e,t,n){this.id=e,this.name=t,this.portraitUri=n}return e}();e.UserInfo=f}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function t(){}var n=e.RongIMClient,o=new tools.Watcher,s={watch:function(e){o.add(e);var t=n._memoryStore.conversationList;o.notify(t)},unwatch:function(e){o.remove(e)},_notify:function(e){o.notify(e)}};return t.prototype.Conversation=s,t.prototype.init=function(t){new e.FeatureDectector},t.prototype.connect=function(t,n){e.RongIMClient.bridge=e.Bridge.getInstance(),e.RongIMClient._memoryStore.token=t,e.RongIMClient._memoryStore.callback=n;var o=!1,s=!1;if(e.Bridge._client&&e.Bridge._client.channel&&(o=e.Bridge._client.channel.connectionStatus==e.ConnectionStatus.CONNECTING,s=e.Bridge._client.channel.connectionStatus==e.ConnectionStatus.CONNECTED),!s&&!o){for(var r=0,i=e.RongIMClient._memoryStore.listenerList.length;r<i;r++)e.RongIMClient.bridge.setListener(e.RongIMClient._memoryStore.listenerList[r]);e.RongIMClient._memoryStore.listenerList.length=0,e.RongIMClient.bridge.connect(e.RongIMClient._memoryStore.appKey,t,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(t){t!=e.ConnectionState.TOKEN_INCORRECT&&t?setTimeout(function(){n.onError(t)}):setTimeout(function(){e.Bridge._client.channel.connectionStatus=e.ConnectionStatus.DISCONNECTED,n.onTokenIncorrect()})}})}},t.prototype.reconnect=function(t){e.MessageIdHandler.clearMessageId();var n=e.RongIMClient._memoryStore.token;e.RongIMClient.connect(n,t)},t.prototype.logout=function(){e.RongIMClient.bridge.disconnect(),e.RongIMClient.bridge=null},t.prototype.disconnect=function(){e.RongIMClient.bridge&&e.RongIMClient.bridge.disconnect()},t.prototype.sendReceiptResponse=function(t,n,o){var s=e.Bridge._client.userId+t+n+"RECEIVED",r=this;if(e.MessageUtil.supportLargeStorage()){var i=JSON.parse(e.RongIMClient._storageProvider.getItem(s));if(i){var a=[];for(var c in i){var u={};u[c]=i[c].uIds,i[c].isResponse||a.push(u)}if(0==a.length)return void o.onSuccess();var g=setInterval(function(){1==a.length&&clearInterval(g);var c=a.splice(0,1)[0],u=new e.ReadReceiptResponseMessage({receiptMessageDic:c});r.sendMessage(t,n,u,{onSuccess:function(t){var n=e.MessageUtil.getFirstKey(c);i[n].isResponse=!0,e.RongIMClient._storageProvider.setItem(s,JSON.stringify(i)),o.onSuccess(t)},onError:function(e,t){o.onError(e,t)}})},200)}else o.onSuccess()}else o.onSuccess()},t.prototype.sendTypingStatusMessage=function(t,n,o,s){var r=this;o in e.RongIMClient.MessageParams&&r.sendMessage(t,n,e.TypingStatusMessage.obtain(e.RongIMClient.MessageParams[o].objectName,""),{onSuccess:function(){setTimeout(function(){s.onSuccess()})},onError:function(e){setTimeout(function(){s.onError(e,null)})},onBefore:function(){}})},t.prototype.sendRecallMessage=function(t,n){var o=new e.RecallCommandMessage({conversationType:t.conversationType,targetId:t.targetId,sentTime:t.sentTime,messageUId:t.messageUId,extra:t.extra,user:t.user});this.sendMessage(t.conversationType,t.senderUserId,o,n,!1,null,null,2)},t.prototype.sendTextMessage=function(t,n,o,s){var r=e.TextMessage.obtain(o);this.sendMessage(t,n,r,s)},t.prototype.getRemoteHistoryMessages=function(t,n,o,s,r){if(s<=1)throw new Error("the count must be greater than 1.");var i=new Modules.HistoryMessageInput;i.setTargetId(n),0===o||o>0?i.setDataTime(o):i.setDataTime(e.RongIMClient._memoryStore.lastReadTime.get(t+n)),i.setSize(s),e.RongIMClient.bridge.queryMsg(HistoryMsgType[t],e.MessageUtil.ArrayForm(i.toArrayBuffer()),n,{onSuccess:function(o){var s=o.hasMsg;e.RongIMClient._memoryStore.lastReadTime.set(t+n,e.MessageUtil.int64ToTimestamp(o.syncTime));var i,a=o.list.reverse(),c=null;if(e.MessageUtil.supportLargeStorage())for(var u=0,g=a.length;u<g;u++){c=e.MessageUtil.messageParser(a[u]);var p=e.Bridge._client.userId+c.messageUId+"SENT",o=e.RongIMClient._storageProvider.getItem(p);i&&(i=JSON.parse(o),c.receiptResponse||(c.receiptResponse={}),c.receiptResponse[c.messageUId]=i.count),a[u]=c}else for(var u=0,g=a.length;u<g;u++)a[u]=e.MessageUtil.messageParser(a[u]);setTimeout(function(){r.onSuccess(a,s)})},onError:function(t){setTimeout(function(){t===e.ErrorCode.TIMEOUT?r.onError(t):r.onSuccess([],!1)})}},"HistoryMessagesOuput")},t.prototype.hasRemoteUnreadMessages=function(t,n){var o=e.RongIMClient._memoryStore.depend.api+"/message/exist.js?appKey="+encodeURIComponent(e.RongIMClient._memoryStore.appKey)+"&token="+encodeURIComponent(t)+"&callBack=RCCallback&_="+Date.now();tools.request({url:o,data:{t:Math.random()}},{success:function(){setTimeout(function(){n.onSuccess(!!+x.status)})},fail:function(){setTimeout(function(){n.onError(e.ErrorCode.UNKNOWN)})}})},t.prototype.getRemoteConversationList=function(t,n,o){var s=new Modules.RelationsInput;s.setType(1),void 0===o?s.setCount(0):s.setCount(o),e.RongIMClient.bridge.queryMsg(26,e.MessageUtil.ArrayForm(s.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(o){if(o.info){o.info=o.info.reverse();for(var s=0,r=o.info.length;s<r;s++)e.RongIMClient.getInstance().pottingConversation(o.info[s])}if(n){var i=[];Array.forEach(n,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){e.conversationType==t&&i.push(e)})}),t.onSuccess(e.RongIMClient._memoryStore.conversationList)}else t.onSuccess(e.RongIMClient._memoryStore.conversationList)},onError:function(n){n===e.ErrorCode.TIMEOUT?t.onError(n):t.onSuccess([])}},"RelationsOutput")},t.prototype.addMemberToDiscussion=function(t,n,o){var s=new Modules.ChannelInvitationInput;s.setUsers(n),e.RongIMClient.bridge.queryMsg(0,e.MessageUtil.ArrayForm(s.toArrayBuffer()),t,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.JOIN_IN_DISCUSSION)})}})},t.prototype.createDiscussion=function(t,n,o){var s=new Modules.CreateDiscussionInput,r=this;s.setName(t),e.RongIMClient.bridge.queryMsg(1,e.MessageUtil.ArrayForm(s.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){n.length>0&&r.addMemberToDiscussion(e,n,{onSuccess:function(){},onError:function(e){setTimeout(function(){o.onError(e)})}}),setTimeout(function(){o.onSuccess(e)})},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.CREATE_DISCUSSION)})}},"CreateDiscussionOutput")},t.prototype.getDiscussion=function(t,n){var o=new Modules.ChannelInfoInput;o.setNothing(1),e.RongIMClient.bridge.queryMsg(4,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(e){setTimeout(function(){n.onError(e)})}},"ChannelInfoOutput")},t.prototype.quitDiscussion=function(t,n){var o=new Modules.LeaveChannelInput;o.setNothing(1),e.RongIMClient.bridge.queryMsg(7,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,n)},t.prototype.removeMemberFromDiscussion=function(t,n,o){var s=new Modules.ChannelEvictionInput;s.setUser(n),e.RongIMClient.bridge.queryMsg(9,e.MessageUtil.ArrayForm(s.toArrayBuffer()),t,o)},t.prototype.setDiscussionInviteStatus=function(t,n,o){var s=new Modules.ModifyPermissionInput;s.setOpenStatus(n.valueOf()),e.RongIMClient.bridge.queryMsg(11,e.MessageUtil.ArrayForm(s.toArrayBuffer()),t,{onSuccess:function(e){setTimeout(function(){o.onSuccess()})},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.INVITE_DICUSSION)})}})},t.prototype.setDiscussionName=function(t,n,o){var s=new Modules.RenameChannelInput;s.setName(n),e.RongIMClient.bridge.queryMsg(12,e.MessageUtil.ArrayForm(s.toArrayBuffer()),t,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(e){o.onError(e)}})},t.prototype.joinGroup=function(t,n,o){var s=new Modules.GroupInfo;s.setId(t),s.setName(n);var r=new Modules.GroupInput;r.setGroupInfo([s]),e.RongIMClient.bridge.queryMsg(6,e.MessageUtil.ArrayForm(r.toArrayBuffer()),t,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(e){o.onError(e)}},"GroupOutput")},t.prototype.quitGroup=function(t,n){var o=new Modules.LeaveChannelInput;o.setNothing(1),e.RongIMClient.bridge.queryMsg(8,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,{onSuccess:function(){setTimeout(function(){n.onSuccess()})},onError:function(e){n.onError(e)}})},t.prototype.syncGroup=function(t,n){for(var o=0,s=[],r=[],i=t.length;o<i;o++)if(0===s.length||!(t[o].id in s)){s.push(t[o].id);var a=new Modules.GroupInfo;a.setId(t[o].id),a.setName(t[o].name),r.push(a)}var c=new Modules.GroupHashInput;c.setUserId(e.Bridge._client.userId),c.setGroupHashCode(md5(s.sort().join(""))),e.RongIMClient.bridge.queryMsg(13,e.MessageUtil.ArrayForm(c.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(t){if(1===t){var o=new Modules.GroupInput;o.setGroupInfo(r),e.RongIMClient.bridge.queryMsg(20,e.MessageUtil.ArrayForm(o.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(){setTimeout(function(){n.onSuccess()})},onError:function(){setTimeout(function(){n.onError(e.ErrorCode.GROUP_MATCH_ERROR)})}},"GroupOutput")}else setTimeout(function(){n.onSuccess()})},onError:function(){setTimeout(function(){n.onError(e.ErrorCode.GROUP_SYNC_ERROR)})}},"GroupHashOutput")},t.prototype.joinChatRoom=function(t,n,o){var s=new Modules.ChrmInput;s.setNothing(1),e.Bridge._client.chatroomId=t,e.RongIMClient.bridge.queryMsg(19,e.MessageUtil.ArrayForm(s.toArrayBuffer()),t,{onSuccess:function(){o.onSuccess();var s=new Modules.ChrmPullMsg;0==n&&(n=-1),s.setCount(n),s.setSyncTime(0),e.Bridge._client.queryMessage("chrmPull",e.MessageUtil.ArrayForm(s.toArrayBuffer()),t,1,{onSuccess:function(n){var o=e.MessageUtil.int64ToTimestamp(n.syncTime);e.RongIMClient._memoryStore.lastReadTime.set(t+e.Bridge._client.userId+"CST",o);var s=n.list;if(e.RongIMClient._memoryStore.filterMessages.length>0)for(var r=0,i=s.length;r<i;r++)for(var a=0,c=e.RongIMClient._memoryStore.filterMessages.length;a<c;a++)e.RongIMClient.MessageParams[e.RongIMClient._memoryStore.filterMessages[a]].objectName!=s[r].classname&&e.Bridge._client.handler.onReceived(s[r]);else for(var r=0,u=s.length;r<u;r++)e.Bridge._client.handler.onReceived(s[r])},onError:function(t){setTimeout(function(){o.onError(e.ErrorCode.CHATROOM_HISMESSAGE_ERROR)})}},"DownStreamMessages")},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.CHARTOOM_JOIN_ERROR)})}},"ChrmOutput")},t.prototype.getChatRoomInfo=function(t,n,o,s){var r=new Modules.QueryChatroomInfoInput;r.setCount(n),r.setOrder(o),e.RongIMClient.bridge.queryMsg("queryChrmI",e.MessageUtil.ArrayForm(r.toArrayBuffer()),t,{onSuccess:function(t){t.userInfos.forEach(function(t){t.time=e.MessageUtil.int64ToTimestamp(t.time)}),setTimeout(function(){s.onSuccess(t)})},onError:function(e){s.onError(e)}},"QueryChatroomInfoOutput")},t.prototype.quitChatRoom=function(t,n){var o=new Modules.ChrmInput;o.setNothing(1),e.RongIMClient.bridge.queryMsg(17,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,{onSuccess:function(){setTimeout(function(){n.onSuccess()})},onError:function(e){n.onError(e)}},"ChrmOutput")},t.prototype.setChatroomHisMessageTimestamp=function(t,n){e.RongIMClient._memoryStore.lastReadTime.set("chrhis_"+t,n)},t.prototype.getChatRoomHistoryMessages=function(t,n,o,s){var r=new Modules.HistoryMsgInput;r.setTargetId(t);var i=e.RongIMClient._memoryStore.lastReadTime.get("chrhis_"+t)||0;r.setTime(i),r.setCount(n),r.setOrder(o),e.RongIMClient.bridge.queryMsg(34,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(n){e.RongIMClient._memoryStore.lastReadTime.set("chrhis_"+t,e.MessageUtil.int64ToTimestamp(n.syncTime));for(var o=n.list.reverse(),r=0,i=o.length;r<i;r++)o[r]=e.MessageUtil.messageParser(o[r]);setTimeout(function(){s.onSuccess(o,!!n.hasMsg)})},onError:function(t){setTimeout(function(){t===e.ErrorCode.TIMEOUT?s.onError(t):s.onSuccess([],!1)})}},"HistoryMsgOuput")},t.prototype.setMessageStatus=function(e,t,n,o,s){s.onSuccess(!0)},t.prototype.addToBlacklist=function(t,n){var o=new Modules.Add2BlackListInput;o.setUserId(t),e.RongIMClient.bridge.queryMsg(21,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,{onSuccess:function(){n.onSuccess()},onError:function(){n.onError(e.ErrorCode.BLACK_ADD_ERROR)}})},t.prototype.getBlacklist=function(t){var n=new Modules.QueryBlackListInput;n.setNothing(1),e.RongIMClient.bridge.queryMsg(23,e.MessageUtil.ArrayForm(n.toArrayBuffer()),e.Bridge._client.userId,t,"QueryBlackListOutput")},t.prototype.getBlacklistStatus=function(t,n){var o=new Modules.BlackListStatusInput;o.setUserId(t),e.RongIMClient.bridge.queryMsg(24,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,{onSuccess:function(t){setTimeout(function(){n.onSuccess(e.BlacklistStatus[t])})},onError:function(){setTimeout(function(){n.onError(e.ErrorCode.BLACK_GETSTATUS_ERROR)})}})},t.prototype.removeFromBlacklist=function(t,n){var o=new Modules.RemoveFromBlackListInput;o.setUserId(t),e.RongIMClient.bridge.queryMsg(22,e.MessageUtil.ArrayForm(o.toArrayBuffer()),t,{onSuccess:function(){n.onSuccess()},onError:function(){n.onError(e.ErrorCode.BLACK_REMOVE_ERROR)}})},t.prototype.getFileToken=function(t,n){if(!/(1|2|3|4)/.test(t.toString()))return void n.onError(e.ErrorCode.QNTKN_FILETYPE_ERROR);var o=new Modules.GetQNupTokenInput;o.setType(t),e.RongIMClient.bridge.queryMsg(30,e.MessageUtil.ArrayForm(o.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(e){n.onError(e)}},"GetQNupTokenOutput")},t.prototype.getFileUrl=function(t,n,o,s){if(!/(1|2|3|4)/.test(t.toString()))return void setTimeout(function(){s.onError(e.ErrorCode.QNTKN_FILETYPE_ERROR)});var r=new Modules.GetQNdownloadUrlInput;r.setType(t),r.setKey(n),o&&r.setFileName(o),e.RongIMClient.bridge.queryMsg(31,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){s.onError(e)}},"GetQNdownloadUrlOutput")},t.prototype.sendMessage=function(t,n,o,s,r,i,a,c){if(!e.Bridge._client.channel)return void s.onError(e.ErrorCode.RC_NET_UNAVAILABLE,null);var u=new Modules.UpStreamMessage;if(!r||t!=e.ConversationType.DISCUSSION&&t!=e.ConversationType.GROUP?u.setSessionId(e.RongIMClient.MessageParams[o.messageName].msgTag.getMessageTag()):u.setSessionId(7),i&&u.setPushText(i),a&&u.setAppData(a),(t==e.ConversationType.DISCUSSION||t==e.ConversationType.GROUP)&&o.messageName==e.RongIMClient.MessageType.ReadReceiptResponseMessage){var g=o;if(g.receiptMessageDic){var p=[];for(var d in g.receiptMessageDic)p.push(d);u.setUserId(p)}}t!=e.ConversationType.DISCUSSION&&t!=e.ConversationType.GROUP||o.messageName!=e.RongIMClient.MessageType.SyncReadStatusMessage||u.setUserId(e.Bridge._client.userId),u.setClassname(e.RongIMClient.MessageParams[o.messageName].objectName),u.setContent(o.encode());var l=u.toArrayBuffer();"[object ArrayBuffer]"==Object.prototype.toString.call(l)&&(l=[].slice.call(new Int8Array(l)));var f=new e.Message,h=this.getConversation(t,n);3==e.RongIMClient.MessageParams[o.messageName].msgTag.getMessageTag()&&(h||(h=e.RongIMClient.getInstance().createConversation(t,n,"")),h.sentTime=(new Date).getTime(),h.sentStatus=e.SentStatus.SENDING,h.senderUserName="",h.senderUserId=e.Bridge._client.userId,h.notificationStatus=e.ConversationNotificationStatus.DO_NOT_DISTURB,h.latestMessage=f,h.unreadMessageCount=0,e.RongIMClient._dataAccessProvider.addConversation(h,{onSuccess:function(e){}})),e.RongIMClient._memoryStore.converStore=h,f.content=o,f.conversationType=t,f.senderUserId=e.Bridge._client.userId,f.objectName=e.RongIMClient.MessageParams[o.messageName].objectName,f.targetId=n,f.sentTime=(new Date).getTime(),f.messageDirection=e.MessageDirection.SEND,f.sentStatus=e.SentStatus.SENT,f.messageType=o.messageName,e.RongIMClient.bridge.pubMsg(t.valueOf(),l,n,{onSuccess:function(r){if((t==e.ConversationType.DISCUSSION||t==e.ConversationType.GROUP)&&o.messageName==e.RongIMClient.MessageType.ReadReceiptRequestMessage){var i=f.content,a=e.Bridge._client.userId+i.messageUId+"SENT";e.RongIMClient._storageProvider.setItem(a,JSON.stringify({count:0,dealtime:r.timestamp,userIds:{}}))}if(3==e.RongIMClient.MessageParams[f.messageType].msgTag.getMessageTag()){e.RongIMClient._memoryStore.converStore.latestMessage=f;var c=e.RongIMClient;c._dataAccessProvider.Conversation._notify(c._memoryStore.conversationList),e.RongIMClient._dataAccessProvider.addMessage(t,n,f,{onSuccess:function(t){f=t,f.messageUId=r.messageUId,f.sentTime=r.timestamp,f.sentStatus=e.SentStatus.SENT,f.messageId=r.messageId,e.RongIMClient._dataAccessProvider.updateMessage(f)},onError:function(){}})}setTimeout(function(){f.sentTime=r.timestamp,f.messageUId=r.messageUId,s.onSuccess(f)})},onError:function(o){f.sentStatus=e.SentStatus.FAILED,3==e.RongIMClient.MessageParams[f.messageType].msgTag.getMessageTag()&&(e.RongIMClient._memoryStore.converStore.latestMessage=f),e.RongIMClient._dataAccessProvider.addMessage(t,n,f,{onSuccess:function(t){f.messageId=t.messageId,e.RongIMClient._dataAccessProvider.updateMessage(f)},onError:function(){}}),setTimeout(function(){s.onError(o,f)})}},null,c),s.onBefore&&s.onBefore(e.MessageIdHandler.messageId),f.messageId=e.MessageIdHandler.messageId+""},t.prototype.setConnectionStatusListener=function(t){e.RongIMClient.bridge?e.RongIMClient.bridge.setListener(t):e.RongIMClient._memoryStore.listenerList.push(t)},t.prototype.setOnReceiveMessageListener=function(t){e.RongIMClient.bridge?e.RongIMClient.bridge.setListener(t):e.RongIMClient._memoryStore.listenerList.push(t)},t.prototype.registerMessageType=function(t,n,o,s){if(!t)throw new Error("messageType can't be empty,postion -> registerMessageType");if(!n)throw new Error("objectName can't be empty,postion -> registerMessageType");if("[object Array]"==Object.prototype.toString.call(s)){var r=e.ModelUtil.modleCreate(s,t);e.RongIMClient.RegisterMessage[t]=r}else{if("[object Function]"!=Object.prototype.toString.call(s)&&"[object Object]"!=Object.prototype.toString.call(s))throw new Error("The index of 3 parameter was wrong type  must be object or function or array-> registerMessageType");if(!s.encode)throw new Error("encode method has not realized or messageName is undefined-> registerMessageType");if(!s.decode)throw new Error("decode method has not realized -> registerMessageType")}registerMessageTypeMapping[n]=t},t.prototype.addConversation=function(t,n){for(var o=!0,s=0,r=e.RongIMClient._memoryStore.conversationList.length;s<r;s++)if(e.RongIMClient._memoryStore.conversationList[s].conversationType===t.conversationType&&e.RongIMClient._memoryStore.conversationList[s].targetId===t.targetId){e.RongIMClient._memoryStore.conversationList.unshift(e.RongIMClient._memoryStore.conversationList.splice(s,1)[0]),o=!1;break}o&&e.RongIMClient._memoryStore.conversationList.unshift(t),n.onSuccess(!0)},t.prototype.updateConversation=function(t){for(var n=0,o=e.RongIMClient._memoryStore.conversationList.length;n<o;n++)if(t.conversationType===e.RongIMClient._memoryStore.conversationList[n].conversationType&&t.targetId===e.RongIMClient._memoryStore.conversationList[n].targetId){t.conversationTitle&&(e.RongIMClient._memoryStore.conversationList[n].conversationTitle=t.conversationTitle),t.senderUserName&&(e.RongIMClient._memoryStore.conversationList[n].senderUserName=t.senderUserName),t.senderPortraitUri&&(e.RongIMClient._memoryStore.conversationList[n].senderPortraitUri=t.senderPortraitUri),t.latestMessage&&(e.RongIMClient._memoryStore.conversationList[n].latestMessage=t.latestMessage);break}},t.prototype.removeConversation=function(t,n,o){var s=new Modules.RelationsInput;s.setType(t),e.RongIMClient.bridge.queryMsg(27,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(){for(var s=e.RongIMClient._memoryStore.conversationList,r=s.length,i=0;i<r;i++)if(s[i].conversationType==t&&n==s[i].targetId){s.splice(i,1);break}o.onSuccess(!0)},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.CONVER_REMOVE_ERROR)})}})},t.prototype.getMessage=function(t,n){n.onSuccess(new e.Message)},t.prototype.addMessage=function(e,t,n,o){o&&o.onSuccess(n)},t.prototype.removeMessage=function(t,n,o,s){e.RongIMClient.getInstance().deleteRemoteMessages(t,n,o,s)},t.prototype.removeLocalMessage=function(e,t,n,o){o.onSuccess(!0)},t.prototype.updateMessage=function(e,t){t&&t.onSuccess(e)},t.prototype.clearMessages=function(e,t,n){n.onSuccess(!0)},t.prototype.updateMessages=function(t,n,o,s,r){var i=this;"readStatus"==o&&e.RongIMClient._memoryStore.conversationList.length>0&&i.getConversationList({onSuccess:function(e){Array.forEach(e,function(e){e.conversationType==t&&e.targetId==n&&(e.unreadMessageCount=0)})},onError:function(e){r.onError(e)}},null),r.onSuccess(!0)},t.prototype.getConversation=function(t,n,o){for(var s=null,r=0,i=e.RongIMClient._memoryStore.conversationList.length;r<i;r++)if(e.RongIMClient._memoryStore.conversationList[r].conversationType==t&&e.RongIMClient._memoryStore.conversationList[r].targetId==n&&(s=e.RongIMClient._memoryStore.conversationList[r],e.MessageUtil.supportLargeStorage())){var a=e.RongIMClient._storageProvider.getItem("cu"+e.Bridge._client.userId+t+n);0==s.unreadMessageCount&&(s.unreadMessageCount=Number(a))}return o&&o.onSuccess(s),s},t.prototype.getConversationList=function(t,n,o,s){var r=e.RongIMClient._Cahche,i=e.RongIMClient._memoryStore,a=i.conversationList;if(r.isSyncConversations)return t.onSuccess(a);e.RongIMClient.getInstance().getRemoteConversationList({onSuccess:function(n){e.MessageUtil.supportLargeStorage()&&(i.conversationList=n,r.isSyncConversations=!0,Array.forEach(i.conversationList,function(t){var n=e.RongIMClient._storageProvider.getItem("cu"+e.Bridge._client.userId+t.conversationType+t.targetId);0==t.unreadMessageCount&&(t.unreadMessageCount=Number(n))})),e.RongIMClient._memoryStore.isSyncRemoteConverList=!1,t.onSuccess(n)},onError:function(e){t.onSuccess([])}},n,o,s),r.isRunning=!0},t.prototype.clearCache=function(){var t=e.RongIMClient._memoryStore||{};t.conversationList=[],t.isSyncRemoteConverList=!0},t.prototype.clearConversations=function(t,n){Array.forEach(t,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(n){t==n.conversationType&&e.RongIMClient.getInstance().removeConversation(n.conversationType,n.targetId,{onSuccess:function(){},onError:function(){}})})}),n.onSuccess(!0)},t.prototype.setMessageContent=function(e,t,n){},t.prototype.getHistoryMessages=function(t,n,o,s,r){e.RongIMClient.getInstance().getRemoteHistoryMessages(t,n,o,s,r)},t.prototype.getTotalUnreadCount=function(t,n){var o=0;if(n)for(var s=0,r=n.length;s<r;s++)Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){e.conversationType==n[s]&&(o+=e.unreadMessageCount)});else Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){o+=e.unreadMessageCount});t.onSuccess(o)},t.prototype.getConversationUnreadCount=function(t,n){var o=0;Array.forEach(t,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){e.conversationType==t&&(o+=e.unreadMessageCount)})}),n.onSuccess(o)},t.prototype.getUnreadCount=function(e,t,n){this.getConversation(e,t,{onSuccess:function(e){n.onSuccess(e?e.unreadMessageCount:0)},onError:function(e){n.onError(e)}})},t.prototype.clearUnreadCountByTimestamp=function(e,t,n,o){o.onSuccess(!0)},t.prototype.cleanMentioneds=function(t){if(t){t.mentionedMsg=null;var n=t.targetId,o=t.conversationType,s=e.RongIMClient._storageProvider.getItem("mentioneds_"+e.Bridge._client.userId+"_"+o+"_"+n);if(s){var r=JSON.parse(s);delete r[o+"_"+n],e.MessageUtil.isEmpty(r)?e.RongIMClient._storageProvider.removeItem("mentioneds_"+e.Bridge._client.userId+"_"+o+"_"+n):e.RongIMClient._storageProvider.setItem("mentioneds_"+e.Bridge._client.userId+"_"+o+"_"+n,JSON.stringify(r))}}},t.prototype.clearUnreadCount=function(t,o,r){this.getConversation(t,o,{onSuccess:function(i){if(i){var a=i.unreadMessageCount;e.MessageUtil.supportLargeStorage()&&e.RongIMClient._storageProvider.removeItem("cu"+e.Bridge._client.userId+t+o),i.unreadMessageCount=0,i.mentionedMsg=null;var c=e.RongIMClient._storageProvider.getItem("mentioneds_"+e.Bridge._client.userId+"_"+t+"_"+o);if(c){a=!0;var u=JSON.parse(c);delete u[t+"_"+o],e.MessageUtil.isEmpty(u)?e.RongIMClient._storageProvider.removeItem("mentioneds_"+e.Bridge._client.userId+"_"+t+"_"+o):e.RongIMClient._storageProvider.setItem("mentioneds_"+e.Bridge._client.userId+"_"+t+"_"+o,JSON.stringify(u))}}r.onSuccess(!0),a&&s._notify(n._memoryStore.conversationList)},onError:function(e){r.onError(e)}})},t.prototype.clearTotalUnreadCount=function(t){var o=e.RongIMClient._memoryStore.conversationList,r=this,i=!1;if(o)for(var a=0;a<o.length;a++){var c=o[a];c&&(i=!!c.unreadMessageCount||i,c.unreadMessageCount=0,r.cleanMentioneds(c))}var u=e.RongIMClient._storageProvider.getItemKeyList("cu"+e.Bridge._client.userId);i=!!u.length||i;for(var a=0;a<u.length;a++){var g=u[a];e.RongIMClient._storageProvider.removeItem(g)}setTimeout(function(){t.onSuccess(!0),i&&s._notify(n._memoryStore.conversationList)})},t.prototype.setConversationToTop=function(e,t,n,o){var s=this;this.getConversation(e,t,{onSuccess:function(e){e.isTop=n,s.addConversation(e,o),o.onSuccess(!0)},onError:function(e){o.onError(e)}})},t.prototype.clearListeners=function(){},t.prototype.setServerInfo=function(e){},t.prototype.getUnreadMentionedMessages=function(e,t){return null},t.prototype.setConversationHidden=function(e,t,n){},t.prototype.setMessageExtra=function(e,t,n){n.onSuccess(!0)},t.prototype.setMessageReceivedStatus=function(e,t,n){n.onSuccess(!0)},t.prototype.setMessageSentStatus=function(e,t,n){n.onSuccess(!0)},t.prototype.getAllConversations=function(e){e.onSuccess([])},t.prototype.getConversationByContent=function(e,t){t.onSuccess([])},t.prototype.getMessagesFromConversation=function(e,t,n,o){o.onSuccess([])},t.prototype.searchConversationByContent=function(e,t,n){t.onSuccess([])},t.prototype.searchMessageByContent=function(e,t,n,o,s,r,i){i.onSuccess([])},t.prototype.getDelaTime=function(){return e.RongIMClient._memoryStore.deltaTime},t.prototype.getUserStatus=function(t,n){n.onSuccess(new e.UserStatus)},t.prototype.setUserStatus=function(e,t){t.onSuccess(!0)},t.prototype.subscribeUserStatus=function(e,t){t.onSuccess(!0)},t.prototype.setOnReceiveStatusListener=function(e){e()},t}();e.ServerDataProvider=t}(RongIMLib||(RongIMLib={})),function(e){e.LocalStorageProvider={setItem:function(e,t){e&&(-1==e.indexOf("rong_")&&(e="rong_"+e),wx.setStorageSync(e,t))},getItem:function(e){return e?(-1==e.indexOf("rong_")&&(e="rong_"+e),wx.getStorageSync(e)):""},getItemKey:function(e){-1==e.indexOf("rong_")&&(e="rong_"+e);var t="";return wx.getStorageInfoSync().keys.forEach(function(n){0==n.indexOf(e)&&(t=n)}),t},getItemKeyList:function(e){-1==e.indexOf("rong_")&&(e="rong_"+e);var t=[];return wx.getStorageInfoSync().keys.forEach(function(n){0==n.indexOf(e)&&(n=n.substring("rong_".length),t.push(n))}),t},removeItem:function(e){e&&(-1==e.indexOf("rong_")&&(e="rong_"+e),wx.removeStorageSync(e))},clearItem:function(){wx.getStorageInfoSync().keys.forEach(function(e){0==e.indexOf("rong_")&&wx.removeStorageSync(e)})},onOutOfQuota:function(){return JSON.stringify(localStorage).length}}}(RongIMLib||(RongIMLib={})),function(e){e.FeatureDectector=function(){}}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function e(){}return e.prototype.patchAll=function(){this.patchJSON(),this.patchForEach()},e.prototype.patchForEach=function(){Array.forEach||(Array.forEach=function(e,t){for(var n=0;n<e.length;n++)t.call(e,e[n],n,e)})},e.prototype.patchJSON=function(){},e}();e.FeaturePatcher=t}(RongIMLib||(RongIMLib={})),function(e){var t=function(){function e(){}return e.isEmpty=function(e){var t=!0;for(var n in e){t=!1;break}return t},e.buildOptions=function(e,t,n){if("object"==(void 0===e?"undefined":_typeof(e)))for(var o in t)"navi"==o||"api"==o?e[o]&&(t[o]=n+e[o]):e[o]&&(t[o]=e[o]);return t},e}();e.ObjectTools=t;var n=function(){function e(){this.publicServiceList=[]}return e.prototype.get=function(e,t){for(var n=0,o=this.publicServiceList.length;n<o;n++)if(this.publicServiceList[n].conversationType==e&&t==this.publicServiceList[n].publicServiceId)return this.publicServiceList[n]},e.prototype.add=function(e){for(var t=!0,n=this,o=0,s=this.publicServiceList.length;o<s;o++)if(n.publicServiceList[o].conversationType==e.conversationType&&e.publicServiceId==n.publicServiceList[o].publicServiceId){this.publicServiceList.unshift(this.publicServiceList.splice(o,1)[0]),t=!1;break}t&&this.publicServiceList.unshift(e)},e.prototype.replace=function(e){for(var t=this,n=0,o=this.publicServiceList.length;n<o;n++)if(t.publicServiceList[n].conversationType==e.conversationType&&e.publicServiceId==t.publicServiceList[n].publicServiceId){t.publicServiceList.splice(n,1,e);break}},e.prototype.remove=function(e,t){for(var n=this,o=0,s=this.publicServiceList.length;o<s;o++)if(n.publicServiceList[o].conversationType==e&&t==n.publicServiceList[o].publicServiceId){this.publicServiceList.splice(o,1);break}},e}();e.PublicServiceMap=n;var o=function(){function e(){this.conversationList=[]}return e.prototype.get=function(e,t){for(var n=0,o=this.conversationList.length;n<o;n++)if(this.conversationList[n].conversationType==e&&this.conversationList[n].targetId==t)return this.conversationList[n];return null},e.prototype.add=function(e){for(var t=!0,n=0,o=this.conversationList.length;n<o;n++)if(this.conversationList[n].conversationType===e.conversationType&&this.conversationList[n].targetId===e.targetId){this.conversationList.unshift(this.conversationList.splice(n,1)[0]),t=!1;break}t&&this.conversationList.unshift(e)},e.prototype.replace=function(e){for(var t=0,n=this.conversationList.length;t<n;t++)if(this.conversationList[t].conversationType===e.conversationType&&this.conversationList[t].targetId===e.targetId){this.conversationList.splice(t,1,e);break}},e.prototype.remove=function(e){for(var t=0,n=this.conversationList.length;t<n;t++)if(this.conversationList[t].conversationType===e.conversationType&&this.conversationList[t].targetId===e.targetId){this.conversationList.splice(t,1);break}},e}();e.ConversationMap=o;var s=function(){function t(){}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.check=function(t,n,o,s){if(!e.RongIMClient._dataAccessProvider&&!o)throw new Error("The parameter is incorrect or was not yet instantiated RongIMClient -> position:"+n);for(var r=0,i=s.length;r<i;r++)if(!new RegExp(this.getType(s[r])).test(t[r]))throw new Error("The index of "+r+" parameter was wrong type "+this.getType(s[r])+" ["+t[r]+"] -> position:"+n)},t.prototype.getType=function(e){var t=Object.prototype.toString.call(e).toLowerCase();return t.slice(8,t.length-1)},t}();e.CheckParam=s;var r=function(){function e(e){this.map={},this.keys=[],this.limit=e||10}return e.prototype.set=function(e,t){this.map[e]=t},e.prototype.get=function(e){return this.map[e]||0},e.prototype.remove=function(e){delete this.map[e]},e}();e.LimitableMap=r;var i=function(){function e(e){var t=this;t.xmlhttp=null,t.options=e;var n="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;"undefined"!=typeof XMLHttpRequest&&n?t.xmlhttp=new XMLHttpRequest:"undefined"!=typeof XDomainRequest?t.xmlhttp=new XDomainRequest:t.xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}return e.prototype.send=function(e){var t=this;t.options.url||(t.options.url="http://upload.qiniu.com/putb64/-1"),t.xmlhttp.onreadystatechange=function(){4==t.xmlhttp.readyState&&(t.options.type?e():e(JSON.parse(t.xmlhttp.responseText.replace(/'/g,'"'))))},t.xmlhttp.open("POST",t.options.url,!0),t.xmlhttp.withCredentials=!1,"setRequestHeader"in t.xmlhttp&&(t.options.type?t.xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8"):(t.xmlhttp.setRequestHeader("Content-type","application/octet-stream"),t.xmlhttp.setRequestHeader("Authorization","UpToken "+t.options.token))),t.xmlhttp.send(t.options.type?"appKey="+t.options.appKey+"&deviceId="+t.options.deviceId+"&timestamp="+t.options.timestamp+"&deviceInfo="+t.options.deviceInfo+"&privateInfo="+JSON.stringify(t.options.privateInfo):t.options.base64)},e}();e.RongAjax=i}(RongIMLib||(RongIMLib={})),RongIMLib}(wx);